<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="prev" title="Welcome to Econox’s documentation!" href="index.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>API Reference - Econox 0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/version_tabs.css?v=741ea410" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     
    <div class="version-tabs-container">
      <a href="/econox/stable/" class="version-tab selected">Stable</a>
      <a href="/econox/latest/" class="version-tab">Latest (dev)</a>
    </div>
     
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Econox 0.1.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">Econox 0.1.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">API Reference</a><input aria-label="Toggle navigation of API Reference" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="simple">
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/api_reference.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="workflow-high-level-api">
<h2>Workflow (High-Level API)<a class="headerlink" href="#workflow-high-level-api" title="Link to this heading">¶</a></h2>
<p>The primary interface for managing the estimation workflow.</p>
<p id="module-econox.workflow.estimator">Estimator module for the Econox framework.
Orchestrates the estimation process by connecting Data, Model, Solver, and Objective.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.workflow.estimator.</span></span><span class="sig-name descname"><span class="pre">Estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/workflow/estimator.html#Estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.workflow.estimator.Estimator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Orchestrates the structural estimation process.</p>
<p>Handles:
1. Parameter transformation (Raw &lt;-&gt; Constrained) via ParameterSpace.
2. Solving the model (Single run or Batched Simulation/SMM).
3. Evaluating the loss function via EstimationMethod.
4. Minimizing the loss using an Optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – StructuralModel - The structural model to estimate.</p></li>
<li><p><strong>param_space</strong> – ParameterSpace - Parameter transformation and constraints.</p></li>
<li><p><strong>method</strong> – EstimationMethod - Strategy for estimation (Loss definition &amp; Inference).</p></li>
<li><p><strong>solver</strong> – Solver | None - Solver to compute model solutions. Not required for reduced-form estimation.</p></li>
<li><p><strong>optimizer</strong> – Minimizer - Optimization strategy for minimizing the loss.</p></li>
<li><p><strong>verbose</strong> – bool - If True, enables detailed logging for debugging.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
<li><p><strong>param_space</strong> (<a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><em>ParameterSpace</em></a>)</p></li>
<li><p><strong>method</strong> (<a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><em>EstimationMethod</em></a>)</p></li>
<li><p><strong>solver</strong> (<a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><em>Solver</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>optimizer</strong> (<a class="reference internal" href="#econox.optim.Minimizer" title="econox.optim.Minimizer"><em>Minimizer</em></a>)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Setup components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param_space</span> <span class="o">=</span> <span class="n">ParameterSpace</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">ValueIterationSolver</span><span class="p">(</span><span class="n">utility</span><span class="o">=...</span><span class="p">,</span> <span class="n">dist</span><span class="o">=...</span><span class="p">,</span> <span class="n">discount_factor</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="n">MaximumLikelihood</span><span class="p">(</span><span class="n">model_key</span><span class="o">=</span><span class="s2">&quot;choice_probs&quot;</span><span class="p">,</span> <span class="n">obs_key</span><span class="o">=</span><span class="s2">&quot;actions&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Initialize Estimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">Estimator</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">param_space</span><span class="o">=</span><span class="n">param_space</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">method</span><span class="o">=</span><span class="n">method</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3. Run estimation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">observations</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.param_space">
<span class="sig-name descname"><span class="pre">param_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterSpace</span></code></a></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.param_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.method">
<span class="sig-name descname"><span class="pre">method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.method" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.optim.Minimizer" title="econox.optim.Minimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Minimizer</span></code></a></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.optimizer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.workflow.estimator.Estimator.verbose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_numerical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/workflow/estimator.html#Estimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.workflow.estimator.Estimator.fit" title="Link to this definition">¶</a></dt>
<dd><p>Estimates the model parameters to minimize the objective function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to match (passed to Objective).</p></li>
<li><p><strong>initial_params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Dictionary of initial parameter values (Constrained space).
If None, uses initial_params from ParameterSpace.</p></li>
<li><p><strong>sample_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Effective sample size for variance calculations.
Note: This argument is primarily for numerical estimation.
If an analytical solution is found, this argument
is ignored and the actual data size (n_obs) is used instead.</p></li>
<li><p><strong>force_numerical</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If True, forces numerical optimization even if an analytical solution is available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>params</strong>: Estimated parameters (Constrained space).</p></li>
<li><p><strong>loss</strong>: Final loss value.</p></li>
<li><p><strong>success</strong>: Whether optimization was successful.</p></li>
<li><p><strong>std_errors</strong>: Standard errors of estimates (if computed).</p></li>
<li><p><strong>vcov</strong>: Variance-covariance matrix (if computed).</p></li>
<li><p><strong>t_values</strong>: t-statistics of estimates (if computed).</p></li>
<li><p><strong>solver_result</strong>: Final solver result (if applicable).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>EstimationResult containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.workflow.estimator.Estimator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.workflow.estimator.Estimator.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
<li><p><strong>param_space</strong> (<a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><em>ParameterSpace</em></a>)</p></li>
<li><p><strong>method</strong> (<a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><em>EstimationMethod</em></a>)</p></li>
<li><p><strong>solver</strong> (<a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><em>Solver</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>optimizer</strong> (<a class="reference internal" href="#econox.optim.Minimizer" title="econox.optim.Minimizer"><em>Minimizer</em></a>)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="core-interfaces-protocols">
<h2>Core Interfaces (Protocols)<a class="headerlink" href="#core-interfaces-protocols" title="Link to this heading">¶</a></h2>
<p>Abstract base classes and protocols defining the contract for custom components.</p>
<p id="module-econox.protocols">Protocol definitions for the Econox framework.</p>
<p>This module defines the core interfaces (contracts) that enable modularity.
By adhering to these protocols, users can swap out components (e.g., changing
utility functions or solver algorithms) without modifying the rest of the workflow.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">StructuralModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#StructuralModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.StructuralModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Represents the economic environment (State Space and Constraints).</p>
<p>In structural estimation, a model <span class="math notranslate nohighlight">\(M\)</span> is defined by the tuple
<span class="math notranslate nohighlight">\((S, A, T, \Omega)\)</span>, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span>: State space (num_states)</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span>: Action space (num_actions)</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span>: Time horizon (num_periods)</p></li>
<li><p><span class="math notranslate nohighlight">\(\Omega\)</span>: Information set / Data constants (data)</p></li>
</ul>
<p>This protocol abstracts away the storage details of these elements.</p>
<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.num_states">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.num_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.num_actions">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_actions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.num_actions" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.num_periods">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_periods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.num_periods" title="Link to this definition">¶</a></dt>
<dd><p>Number of periods <cite>T</cite> in the model.
Should be a positive integer for finite horizon or <cite>np.inf</cite> for infinite horizon.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PyTree</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.data" title="Link to this definition">¶</a></dt>
<dd><p>Immutable constants <span class="math notranslate nohighlight">\(\Omega\)</span> (features, matrices, etc.).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.transitions">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transitions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PyTree</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.transitions" title="Link to this definition">¶</a></dt>
<dd><p>Transition structure (e.g., transition matrix or adjacency).
Corresponds to <span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.availability">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">availability</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PyTree</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.protocols.StructuralModel.availability" title="Link to this definition">¶</a></dt>
<dd><p>Feasible action set <span class="math notranslate nohighlight">\(A(s)\)</span>.
Boolean mask of shape (num_states, num_actions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.StructuralModel.replace_data">
<span class="sig-name descname"><span class="pre">replace_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#StructuralModel.replace_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.StructuralModel.replace_data" title="Link to this definition">¶</a></dt>
<dd><p>Returns a new instance of the model with the specified data key updated.
Required for Feedback mechanisms to update the environment (e.g., prices).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The name of the data field to update.</p></li>
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The new value for that field.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new StructuralModel instance (immutable update).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.Utility">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">Utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Utility" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Structural Utility Function <span class="math notranslate nohighlight">\(u(s, a; \theta)\)</span>.</p>
<p>Defines the instantaneous payoff an agent receives from taking action <span class="math notranslate nohighlight">\(a\)</span>
in state <span class="math notranslate nohighlight">\(s\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.Utility.compute_flow_utility">
<span class="sig-name descname"><span class="pre">compute_flow_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Utility.compute_flow_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Utility.compute_flow_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the utility matrix given parameters and model state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'n_states</span> <span class="pre">n_actions']</span></code></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.Distribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">Distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Distribution" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Stochastic Shock Distribution <span class="math notranslate nohighlight">\(F(\epsilon)\)</span>.</p>
<p>Defines the properties of the unobserved state variables (error terms).
Handles the smoothing of the max operator (Emax) and choice probabilities (CCP).</p>
<p>Common examples: Type-I Extreme Value (Logit), Normal (Probit).</p>
<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.Distribution.expected_max">
<span class="sig-name descname"><span class="pre">expected_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Distribution.expected_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Distribution.expected_max" title="Link to this definition">¶</a></dt>
<dd><p>Computes the expected maximum value:
<span class="math notranslate nohighlight">\(E[\max_a (v(s, a) + \epsilon(a))]\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'n_states']</span></code></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>values</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'n_states n_actions'</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.Distribution.choice_probabilities">
<span class="sig-name descname"><span class="pre">choice_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Distribution.choice_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Distribution.choice_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Computes conditional choice probabilities (CCP):
<span class="math notranslate nohighlight">\(P(a | s) = P(v(s, a) + \epsilon(a) \ge v(s, a') + \epsilon(a'), \forall a')\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'n_states</span> <span class="pre">n_actions']</span></code></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>values</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'n_states n_actions'</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.FeedbackMechanism">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">FeedbackMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#FeedbackMechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.FeedbackMechanism" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Equilibrium/Market Clearing Condition.</p>
<dl class="simple">
<dt>Defines how aggregate agent behaviors affect the environment (e.g., prices, congestion).</dt><dd><p>Mathematically: <span class="math notranslate nohighlight">\(\Omega' = \Gamma(\sigma, \Omega)\)</span>, where <span class="math notranslate nohighlight">\(\sigma\)</span> is the policy.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.FeedbackMechanism.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#FeedbackMechanism.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.FeedbackMechanism.update" title="Link to this definition">¶</a></dt>
<dd><p>Updates the model environment based on the current solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>current_result</strong> (<em>Any</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.Dynamics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">Dynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Dynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Dynamics" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>State Transition Law of Motion <span class="math notranslate nohighlight">\(s' = f(s, a, \xi)\)</span>.</p>
<p>Defines how the distribution of agents over states evolves over time.
Used for simulation and calculating steady-state distributions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.protocols.Solver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.protocols.</span></span><span class="sig-name descname"><span class="pre">Solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Solver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>Computational Engine for the Model.</p>
<p>A Solver finds the solution (Policy function / Value function) that satisfies
the optimality conditions defined by the Model Primitives.</p>
<dl class="simple">
<dt>Implementation Note:</dt><dd><p>Concrete solvers should store their specific logic (Utility, Distribution)
internally. The <cite>solve</cite> method strictly takes the parameters and the environment.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="econox.protocols.Solver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/protocols.html#Solver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.protocols.Solver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Executes the solution algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Structural parameters <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The economic environment <span class="math notranslate nohighlight">\((S, A, ...)\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A result object (e.g., SolverResult) containing the solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="structures-data-state">
<h2>Structures (Data &amp; State)<a class="headerlink" href="#structures-data-state" title="Link to this heading">¶</a></h2>
<p>Data containers for models, parameters, and results.</p>
<section id="module-econox.structures.model">
<span id="structural-model"></span><h3>Structural Model<a class="headerlink" href="#module-econox.structures.model" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="econox.structures.model.Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.structures.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">availability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.model.Model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Immutable container representing the structural environment.</p>
<p>This class holds all exogenous data (states, transitions, covariates) required
to define the economic model. It is designed to be purely data-centric and
logic-free, ensuring separation between the environment and the behavioral
logic (Utility/Solver).</p>
<p>As an Equinox Module, this class is a valid JAX PyTree, meaning it can be
passed into JIT-compiled functions or differentiated with respect to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<em>int</em>)</p></li>
<li><p><strong>num_actions</strong> (<em>int</em>)</p></li>
<li><p><strong>data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'</em><em>...</em><em>'</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>num_periods</strong> (<em>int</em><em> | </em><em>float</em>)</p></li>
<li><p><strong>availability</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_actions'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>transitions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'</em><em>...</em><em>'</em><em>] </em><em>| </em><em>BCOO</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.num_states">
<span class="sig-name descname"><span class="pre">num_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#econox.structures.model.Model.num_states" title="Link to this definition">¶</a></dt>
<dd><p>Total cardinality of the state space (<span class="math notranslate nohighlight">\(S\)</span>). Used to determine array shapes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.num_actions">
<span class="sig-name descname"><span class="pre">num_actions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#econox.structures.model.Model.num_actions" title="Link to this definition">¶</a></dt>
<dd><p>Total cardinality of the action space (<span class="math notranslate nohighlight">\(A\)</span>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">']</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.structures.model.Model.data" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of environment constants and exogenous variables.</p>
<p>Keys are identifiers (e.g., ‘wage’, ‘distance’, ‘rent’) that must match
the keys expected by the <cite>Utility</cite> component. Values are typically JAX arrays
of shape (<span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(A\)</span>), (<span class="math notranslate nohighlight">\(S\)</span>,), or scalars.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.num_periods">
<span class="sig-name descname"><span class="pre">num_periods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> <span class="pre">|</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#econox.structures.model.Model.num_periods" title="Link to this definition">¶</a></dt>
<dd><p>Time horizon (<span class="math notranslate nohighlight">\(T\)</span>) of the model.</p>
<ul class="simple">
<li><p><cite>np.inf</cite>: Infinite horizon (default).</p></li>
<li><p><cite>int</cite>: Finite horizon.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.availability">
<span class="sig-name descname"><span class="pre">availability</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array,</span> <span class="pre">'num_states</span> <span class="pre">num_actions']</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.model.Model.availability" title="Link to this definition">¶</a></dt>
<dd><p>Binary mask indicating feasible actions.
Shape (<span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(A\)</span>). <cite>1</cite> (or <cite>True</cite>) indicates action <span class="math notranslate nohighlight">\(a\)</span> is available in state <span class="math notranslate nohighlight">\(s\)</span>,
while <cite>0</cite> (or <cite>False</cite>) indicates it is physically impossible.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.model.Model.transitions">
<span class="sig-name descname"><span class="pre">transitions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">']</span></code> <span class="pre">|</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">BCOO</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.model.Model.transitions" title="Link to this definition">¶</a></dt>
<dd><p>Exogenous transition structure.</p>
<p>Depending on the model type, this could be:
* Transition Probability Matrix: <span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>
* Adjacency Matrix (for spatial models)
* Deterministic mapping logic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.model.Model.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">availability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.structures.model.Model.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<em>int</em>)</p></li>
<li><p><strong>num_actions</strong> (<em>int</em>)</p></li>
<li><p><strong>data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'</em><em>...</em><em>'</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>num_periods</strong> (<em>int</em><em> | </em><em>float</em>)</p></li>
<li><p><strong>availability</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_actions'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>transitions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'</em><em>...</em><em>'</em><em>] </em><em>| </em><em>BCOO</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.model.Model.from_data">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">availability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/model.html#Model.from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.model.Model.from_data" title="Link to this definition">¶</a></dt>
<dd><p>Factory method to initialize a Model from raw Python/NumPy data.</p>
<p>This is the recommended entry point. It automatically handles the conversion
of Python lists and NumPy arrays into JAX DeviceArrays, ensuring compatibility
with JIT compilation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Total number of states (<span class="math notranslate nohighlight">\(S\)</span>). Must be positive.</p></li>
<li><p><strong>num_actions</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Total number of actions (<span class="math notranslate nohighlight">\(A\)</span>). Must be positive.</p></li>
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span>) – Dictionary of feature matrices (e.g., <cite>{‘wage’: […]}</cite>).
Keys should be strings, values can be lists, NumPy arrays, or JAX arrays.</p></li>
<li><p><strong>availability</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Optional mask for feasible actions. Shape must be (num_states, num_actions).</p></li>
<li><p><strong>transitions</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Optional transition matrices.</p></li>
<li><p><strong>num_periods</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Time horizon. Defaults to <cite>np.inf</cite> (Infinite). Must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.structures.model.Model" title="econox.structures.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A frozen, JAX-ready <cite>Model</cite> instance.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If dimensions are invalid.</p></li>
<li><p><strong>TypeError</strong> – If data types are incompatible.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Infinite horizon model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">num_states</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_actions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wage&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Finite horizon with availability constraints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">num_states</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_actions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;utility&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]},</span>
<span class="gp">... </span>    <span class="n">availability</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">num_periods</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.model.Model.replace_data">
<span class="sig-name descname"><span class="pre">replace_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/model.html#Model.replace_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.model.Model.replace_data" title="Link to this definition">¶</a></dt>
<dd><p>Creates a NEW Model instance with specific data updated.</p>
<p>This method is essential for counterfactual simulations. It allows you
to create a “What-if” world (e.g., “What if subsidies increase by 10%?”)
without mutating the original baseline model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The name of the data field to update (must exist in <cite>data</cite>).</p></li>
<li><p><strong>value</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The new value for that field.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.structures.model.Model" title="econox.structures.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new <cite>Model</cite> instance with the updated data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.structures.model.Model.features">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#econox.structures.model.Model.features" title="Link to this definition">¶</a></dt>
<dd><p>Alias for <cite>data</cite>, provided for semantic convenience.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.model.Model.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/model.html#Model.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.model.Model.get" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves a data array by name with error handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> – If the name is not found in <cite>data</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></span></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.structures.model.Model.shapes">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shapes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#econox.structures.model.Model.shapes" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of each array in <cite>data</cite> for debugging.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.structures.params">
<span id="parameter-management"></span><h3>Parameter Management<a class="headerlink" href="#module-econox.structures.params" title="Link to this heading">¶</a></h3>
<dl class="py data">
<dt class="sig sig-object py" id="econox.structures.params.ConstraintKind">
<span class="sig-prename descclassname"><span class="pre">econox.structures.params.</span></span><span class="sig-name descname"><span class="pre">ConstraintKind</span></span><a class="headerlink" href="#econox.structures.params.ConstraintKind" title="Link to this definition">¶</a></dt>
<dd><p>Specifies the type of constraint applied to a parameter.</p>
<dl class="simple">
<dt>Options:</dt><dd><ul class="simple">
<li><p><strong>free</strong>: No constraints (-inf, +inf).</p></li>
<li><p><strong>positive</strong>: Must be positive (0, +inf). Used for variances, etc.</p></li>
<li><p><strong>negative</strong>: Must be negative (-inf, 0).</p></li>
<li><p><strong>probability</strong>: Constrained to (0, 1).</p></li>
<li><p><strong>unit_interval</strong>: Alias for “probability”.</p></li>
<li><p><strong>fixed</strong>: Parameter is fixed to its initial value and not optimized.</p></li>
<li><p><strong>bounded</strong>: Constrained to a specific range [lower, upper].</p></li>
</ul>
</dd>
</dl>
<p>alias of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Literal</span></code>[‘free’, ‘positive’, ‘negative’, ‘probability’, ‘unit_interval’, ‘fixed’, ‘bounded’]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.structures.params.</span></span><span class="sig-name descname"><span class="pre">ParameterSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_clip_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_clip_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/params.html#ParameterSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.params.ParameterSpace" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Manages parameter constraints and transformations with numerical stability.
Compliant with the ParameterSpace protocol.</p>
<p>Handles the mapping between:
1. Raw Parameters (Real space, R^n): For the optimizer.
2. Model Parameters (Constrained space): For the economic model.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define initial values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define constraints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>          <span class="c1"># Not optimized</span>
<span class="gp">... </span>    <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span>      <span class="c1"># Domain: (0, inf)</span>
<span class="gp">... </span>    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="s2">&quot;probability&quot;</span><span class="p">,</span>   <span class="c1"># Domain: (0, 1)</span>
<span class="gp">... </span>    <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span>           <span class="c1"># Domain: (-inf, inf) (Default)</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the parameter space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pspace</span> <span class="o">=</span> <span class="n">ParameterSpace</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">init_params</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
<li><p><strong>constraints</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Literal</em><em>[</em><em>'free'</em><em>, </em><em>'positive'</em><em>, </em><em>'negative'</em><em>, </em><em>'probability'</em><em>, </em><em>'unit_interval'</em><em>, </em><em>'fixed'</em><em>, </em><em>'bounded'</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>bounds</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>eps</strong> (<em>float</em>)</p></li>
<li><p><strong>log_clip_min</strong> (<em>float</em>)</p></li>
<li><p><strong>log_clip_max</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.initial_params">
<span class="sig-name descname"><span class="pre">initial_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.initial_params" title="Link to this definition">¶</a></dt>
<dd><p>Initial values of the parameters (Constrained space).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.constraints">
<span class="sig-name descname"><span class="pre">constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'free'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'positive'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'negative'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'probability'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'unit_interval'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'fixed'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'bounded'</span></code><span class="pre">]]</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.constraints" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary mapping parameter names to their constraint types.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.bounds" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary mapping parameter names to (lower, upper) bounds.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-08</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.eps" title="Link to this definition">¶</a></dt>
<dd><p>Small constant for numerical stability.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.log_clip_min">
<span class="sig-name descname"><span class="pre">log_clip_min</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-20.0</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.log_clip_min" title="Link to this definition">¶</a></dt>
<dd><p>Minimum value for log transformations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_clip_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_clip_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.structures.params.ParameterSpace.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
<li><p><strong>constraints</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Literal</em><em>[</em><em>'free'</em><em>, </em><em>'positive'</em><em>, </em><em>'negative'</em><em>, </em><em>'probability'</em><em>, </em><em>'unit_interval'</em><em>, </em><em>'fixed'</em><em>, </em><em>'bounded'</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>bounds</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>eps</strong> (<em>float</em>)</p></li>
<li><p><strong>log_clip_min</strong> (<em>float</em>)</p></li>
<li><p><strong>log_clip_max</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.log_clip_max">
<span class="sig-name descname"><span class="pre">log_clip_max</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">20.0</span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.log_clip_max" title="Link to this definition">¶</a></dt>
<dd><p>Maximum value for log transformations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.create">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/params.html#ParameterSpace.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.params.ParameterSpace.create" title="Link to this definition">¶</a></dt>
<dd><p>Factory method to initialize ParameterSpace.
Validates keys, bounds, and fills default constraints (‘free’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary of initial parameter values.</p></li>
<li><p><strong>constraints</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>ConstraintKind</em><em>] </em><em>| </em><em>None</em>) – Optional dictionary specifying constraints for each parameter. Defaults to ‘free’ for unspecified parameters.</p></li>
<li><p><strong>bounds</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional dictionary specifying (lower, upper) bounds for ‘bounded’ parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterSpace</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/params.html#ParameterSpace.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.params.ParameterSpace.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transform raw (unconstrained) parameters to model (constrained) parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raw_params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span>) – Dictionary of unconstrained parameters. Fixed parameters
should NOT be included in this dictionary.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of constrained parameters including fixed parameters.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If required (non-fixed) parameters are missing or
    unexpected parameters are present.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/params.html#ParameterSpace.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.params.ParameterSpace.inverse_transform" title="Link to this definition">¶</a></dt>
<dd><p>Model parameters (Constrained) -&gt; Raw parameters (Unconstrained).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>model_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/params.html#ParameterSpace.get_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.params.ParameterSpace.get_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Protocol: Returns parameter bounds for the optimizer.</p>
<p>Returns None because this class uses the ‘Transformation Method’ (Unconstrained Optimization).
The optimizer operates on ‘raw_params’ which are unbounded (-inf, +inf).
Constraints are enforced via the ‘transform’ method, not by the optimizer’s bound constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code>] | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.structures.params.ParameterSpace.fixed_mask">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fixed_mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#econox.structures.params.ParameterSpace.fixed_mask" title="Link to this definition">¶</a></dt>
<dd><p>Returns a boolean mask where True indicates a parameter is FIXED.
Useful for masking gradients in the Estimator.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.structures.results">
<span id="result-containers"></span><h3>Result Containers<a class="headerlink" href="#module-econox.structures.results" title="Link to this heading">¶</a></h3>
<p>Data structures for holding computation results.
Uses Equinox modules to allow mixins and PyTree registration.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.structures.results.ResultMixin">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.structures.results.</span></span><span class="sig-name descname"><span class="pre">ResultMixin</span></span><a class="reference internal" href="_modules/econox/structures/results.html#ResultMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.results.ResultMixin" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides a generic <cite>save()</cite> method for Result objects.
Implements the ‘Directory Bundle’ strategy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.results.ResultMixin.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/results.html#ResultMixin.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.results.ResultMixin.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the result object to a directory using the ‘Directory Bundle’ strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – The target directory path where the result will be saved.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, overwrite the directory if it already exists. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileExistsError</strong> – If the target directory already exists and <cite>overwrite</cite> is False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.structures.results.</span></span><span class="sig-name descname"><span class="pre">SolverResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_result=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/results.html#SolverResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.results.SolverResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.structures.results.ResultMixin" title="econox.structures.results.ResultMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultMixin</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Container for the output of a Solver (Inner/Outer Loop).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>profile</strong> (<em>PyTree</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>inner_result</strong> (<a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><em>SolverResult</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>bool</em>)</p></li>
<li><p><strong>aux</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.solution">
<span class="sig-name descname"><span class="pre">solution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></em><a class="headerlink" href="#econox.structures.results.SolverResult.solution" title="Link to this definition">¶</a></dt>
<dd><p>Main solution returned by the solver (the fixed point).</p>
<ul class="simple">
<li><p><strong>DP</strong>: Expected Value Function <span class="math notranslate nohighlight">\(EV(s)\)</span> (Integrated Value Function / Emax).
Represents the expected value <em>before</em> the realization of the shock <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p></li>
<li><p><strong>GE</strong>: Equilibrium allocations (e.g., Population Distribution <span class="math notranslate nohighlight">\(D\)</span>) or Prices <span class="math notranslate nohighlight">\(P\)</span>.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.profile">
<span class="sig-name descname"><span class="pre">profile</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.SolverResult.profile" title="Link to this definition">¶</a></dt>
<dd><p>Associated profile information derived from the solution.</p>
<ul class="simple">
<li><p><strong>DP</strong>: Conditional Choice Probabilities (CCP) <span class="math notranslate nohighlight">\(P(a|s)\)</span>.
The probability of choosing action <span class="math notranslate nohighlight">\(a\)</span> given state <span class="math notranslate nohighlight">\(s\)</span>.</p></li>
<li><p><strong>GE</strong>: Market prices (Wage, Rent) or aggregate states corresponding to the solution.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.inner_result">
<span class="sig-name descname"><span class="pre">inner_result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolverResult</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.SolverResult.inner_result" title="Link to this definition">¶</a></dt>
<dd><p>Associated inner solver result used during nested solving.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.success">
<span class="sig-name descname"><span class="pre">success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Bool[Array,</span> <span class="pre">'']</span></code> <span class="pre">|</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.structures.results.SolverResult.success" title="Link to this definition">¶</a></dt>
<dd><p>Whether the solver converged successfully.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.aux">
<span class="sig-name descname"><span class="pre">aux</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.structures.results.SolverResult.aux" title="Link to this definition">¶</a></dt>
<dd><p>Additional auxiliary information (e.g., diagnostics).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.results.SolverResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_result=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.structures.results.SolverResult.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>profile</strong> (<em>PyTree</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>inner_result</strong> (<a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><em>SolverResult</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>bool</em>)</p></li>
<li><p><strong>aux</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.structures.results.</span></span><span class="sig-name descname"><span class="pre">EstimationResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_result=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_errors=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcov=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_squared=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/structures/results.html#EstimationResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.structures.results.EstimationResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.structures.results.ResultMixin" title="econox.structures.results.ResultMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultMixin</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Container for the output of an Estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>loss</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>float</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>bool</em>)</p></li>
<li><p><strong>solver_result</strong> (<a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><em>SolverResult</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>std_errors</strong> (<em>PyTree</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>vcov</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'n_params n_params'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>r_squared</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>meta</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></em><a class="headerlink" href="#econox.structures.results.EstimationResult.params" title="Link to this definition">¶</a></dt>
<dd><p>Estimated parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code> <span class="pre">|</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#econox.structures.results.EstimationResult.loss" title="Link to this definition">¶</a></dt>
<dd><p>Final value of the loss function (e.g., negative log-likelihood).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_result=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_errors=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcov=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_squared=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.structures.results.EstimationResult.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>loss</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>float</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>bool</em>)</p></li>
<li><p><strong>solver_result</strong> (<a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><em>SolverResult</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>std_errors</strong> (<em>PyTree</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>vcov</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'n_params n_params'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>r_squared</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>meta</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.success">
<span class="sig-name descname"><span class="pre">success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Bool[Array,</span> <span class="pre">'']</span></code> <span class="pre">|</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.success" title="Link to this definition">¶</a></dt>
<dd><p>Whether the estimation converged successfully.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.solver_result">
<span class="sig-name descname"><span class="pre">solver_result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolverResult</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.solver_result" title="Link to this definition">¶</a></dt>
<dd><p>Associated (outermost) solver result used during estimation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.std_errors">
<span class="sig-name descname"><span class="pre">std_errors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.std_errors" title="Link to this definition">¶</a></dt>
<dd><p>Standard errors of the estimated parameters, if available.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.vcov">
<span class="sig-name descname"><span class="pre">vcov</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'n_params</span> <span class="pre">n_params']</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.vcov" title="Link to this definition">¶</a></dt>
<dd><p>Variance-covariance matrix of the estimated parameters, if available.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.r_squared">
<span class="sig-name descname"><span class="pre">r_squared</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.r_squared" title="Link to this definition">¶</a></dt>
<dd><p>R-squared statistic for goodness-of-fit, if available.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.meta">
<span class="sig-name descname"><span class="pre">meta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.meta" title="Link to this definition">¶</a></dt>
<dd><p>Additional metadata about the estimation process (e.g., convergence criteria, iteration counts, duration).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="econox.structures.results.EstimationResult.t_values">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PyTree</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.structures.results.EstimationResult.t_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute t-values if standard errors are available.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="logic-physics-rules">
<h2>Logic (Physics &amp; Rules)<a class="headerlink" href="#logic-physics-rules" title="Link to this heading">¶</a></h2>
<p>Components defining the economic logic and mechanics of the model.</p>
<section id="module-econox.logic.utility">
<span id="utility-functions"></span><h3>Utility Functions<a class="headerlink" href="#module-econox.logic.utility" title="Link to this heading">¶</a></h3>
<p>Utility components for the Econox framework.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.utility.LinearUtility">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.utility.</span></span><span class="sig-name descname"><span class="pre">LinearUtility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/utility.html#LinearUtility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.utility.LinearUtility" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Computes flow utility as a linear combination of features and parameters.</p>
<p>This module implements the standard linear utility specification:
.. math:: U(s, a) = sum_{k} beta_k cdot X_k(s, a)</p>
<p>It expects parameters to be provided as individual scalars (or consistent arrays)
corresponding to the last dimension of the feature tensor. This design enforces
explicit naming of parameters, facilitating integration with <cite>ParameterSpace</cite>
for constraints and interpretation.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_keys</strong> (<em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – A sequence of keys to retrieve coefficients from the parameter PyTree.
Order must match the last dimension of the feature tensor.
Example: <cite>(“beta_income”, “beta_distance”)</cite></p></li>
<li><p><strong>feature_key</strong> (<em>str</em>) – Key to retrieve the feature tensor from <cite>model.data</cite>.
The tensor must have shape <cite>(num_states, num_actions, num_features)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>param_keys</strong> (<em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>feature_key</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Model data has features shape (100, 5, 2) -&gt; 2 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utility</span> <span class="o">=</span> <span class="n">LinearUtility</span><span class="p">(</span><span class="n">param_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;beta_0&quot;</span><span class="p">,</span> <span class="s2">&quot;beta_1&quot;</span><span class="p">),</span> <span class="n">feature_key</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Params must contain &quot;beta_0&quot; and &quot;beta_1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">utility</span><span class="o">.</span><span class="n">compute_flow_utility</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(100, 5)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.utility.LinearUtility.param_keys">
<span class="sig-name descname"><span class="pre">param_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.logic.utility.LinearUtility.param_keys" title="Link to this definition">¶</a></dt>
<dd><p>Keys in params for the coefficients corresponding to each feature.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.utility.LinearUtility.feature_key">
<span class="sig-name descname"><span class="pre">feature_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#econox.logic.utility.LinearUtility.feature_key" title="Link to this definition">¶</a></dt>
<dd><p>Key in model.data for the feature tensor of shape (num_states, num_actions, num_features).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.utility.LinearUtility.compute_flow_utility">
<span class="sig-name descname"><span class="pre">compute_flow_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/utility.html#LinearUtility.compute_flow_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.utility.LinearUtility.compute_flow_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calculates flow utility using matrix multiplication.</p>
<p>The method retrieves parameters specified by <cite>param_keys</cite>, stacks them into
a single vector, and computes the dot product with the feature tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Parameter PyTree containing the coefficients.
Values for <cite>param_keys</cite> should typically be scalars.</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – StructuralModel containing the feature tensor at <cite>model.data[self.feature_key]</cite>.
Expected shape: <cite>(num_states, num_actions, num_features)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated flow utility matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float[Array, “num_states num_actions”]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the feature tensor is not 3D.</p></li>
<li><p><strong>ValueError</strong> – If the number of <cite>param_keys</cite> does not match the
    last dimension (num_features) of the feature tensor.</p></li>
<li><p><strong>ValueError</strong> – If parameters cannot be stacked (e.g., shape mismatch).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.utility.LinearUtility.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.utility.LinearUtility.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_keys</strong> (<em>tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>feature_key</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.utility.FunctionUtility">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.utility.</span></span><span class="sig-name descname"><span class="pre">FunctionUtility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/utility.html#FunctionUtility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.utility.FunctionUtility" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Wraps a user-defined function to satisfy the Utility protocol.
Allows defining utility logic as a simple function.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>Callable</em>) – A function with signature <cite>(params: PyTree, model: StructuralModel) -&gt; Float[Array, “num_states num_actions”]</cite>.
This function computes the flow utility matrix for the given parameters and model.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>func</strong> (<em>Callable</em>)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">econox</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ecx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a custom utility function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">my_utility</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># params[&quot;beta&quot;] is a scalar, model.data[&quot;x&quot;] is (num_states, num_actions)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Wrap it as a FunctionUtility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utility</span><span class="p">:</span> <span class="n">econox</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">Utility</span> <span class="o">=</span> <span class="n">ecx</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span><span class="n">my_utility</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">utility</span><span class="o">.</span><span class="n">compute_flow_utility</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(num_states, num_actions)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.utility.FunctionUtility.func">
<span class="sig-name descname"><span class="pre">func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#econox.logic.utility.FunctionUtility.func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.utility.FunctionUtility.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.utility.FunctionUtility.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>Callable</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.utility.FunctionUtility.compute_flow_utility">
<span class="sig-name descname"><span class="pre">compute_flow_utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/utility.html#FunctionUtility.compute_flow_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.utility.FunctionUtility.compute_flow_utility" title="Link to this definition">¶</a></dt>
<dd><p>Calls the user-defined function to compute flow utility.
:type params: <span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>
:param params: Parameter PyTree.
:type model: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>
:param model: StructuralModel instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed flow utility matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Float[Array, “num_states num_actions”]</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="econox.logic.utility.utility">
<span class="sig-prename descclassname"><span class="pre">econox.logic.utility.</span></span><span class="sig-name descname"><span class="pre">utility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/utility.html#utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.utility.utility" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to convert a function into a Utility module.</p>
<p>This allows you to define a utility function with the standard signature and
automatically wrap it as a module compatible with the Econox framework.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>Callable</em>) – A function with signature <cite>(params: PyTree, model: StructuralModel) -&gt; Float[Array, “num_states num_actions”]</cite>.
The function should compute and return the flow utility matrix for the given parameters and model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object with a <cite>compute_flow_utility(params, model)</cite> method that calls the provided function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.logic.utility.FunctionUtility" title="econox.logic.utility.FunctionUtility">FunctionUtility</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">econox</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ecx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a custom utility function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ecx</span><span class="o">.</span><span class="n">utility</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">my_utility</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># params[&quot;beta&quot;] is a scalar, model.data[&quot;x&quot;] is (num_states, num_actions)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># my_utility is now a FunctionUtility instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">my_utility</span><span class="o">.</span><span class="n">compute_flow_utility</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(num_states, num_actions)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-econox.logic.distribution">
<span id="probability-distributions"></span><h3>Probability Distributions<a class="headerlink" href="#module-econox.logic.distribution" title="Link to this heading">¶</a></h3>
<p>Distribution components for Econox.
Handles stochastic parts of the model (error terms).</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.distribution.GumbelDistribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.distribution.</span></span><span class="sig-name descname"><span class="pre">GumbelDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/distribution.html#GumbelDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.distribution.GumbelDistribution" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Type I Extreme Value (Gumbel) distribution logic for Logit models.
Provides Emax (LogSumExp) and choice probabilities (Softmax).</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>) – Scale parameter of the Gumbel distribution.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scale</strong> (<em>float</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.distribution.GumbelDistribution.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#econox.logic.distribution.GumbelDistribution.scale" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.distribution.GumbelDistribution.expected_max">
<span class="sig-name descname"><span class="pre">expected_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/distribution.html#GumbelDistribution.expected_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.distribution.GumbelDistribution.expected_max" title="Link to this definition">¶</a></dt>
<dd><p>Computes the expected maximum value E[max(v + epsilon)].</p>
<p>Formula: scale * log( sum( exp(v / scale) ) )
(Note: Standard implementation commonly refers to this as the ‘Inclusive Value’.)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'num_states']</span></code></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>values</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_actions'</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.distribution.GumbelDistribution.choice_probabilities">
<span class="sig-name descname"><span class="pre">choice_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/distribution.html#GumbelDistribution.choice_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.distribution.GumbelDistribution.choice_probabilities" title="Link to this definition">¶</a></dt>
<dd><p>Computes the choice probabilities P(choice | state).</p>
<p>Formula: exp(v / scale) / sum( exp(v / scale) )</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'num_states</span> <span class="pre">num_actions']</span></code></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>values</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_actions'</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.distribution.GumbelDistribution.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.distribution.GumbelDistribution.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.logic.feedback">
<span id="feedback-mechanisms"></span><h3>Feedback Mechanisms<a class="headerlink" href="#module-econox.logic.feedback" title="Link to this heading">¶</a></h3>
<p>Feedback mechanisms for General Equilibrium (GE) interactions.</p>
<p>This module provides the infrastructure for defining and executing feedback loops
in structural models. It supports both component-wise updates (FunctionFeedback)
and full-model updates (CustomUpdateFeedback).</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.feedback.CompositeFeedback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.feedback.</span></span><span class="sig-name descname"><span class="pre">CompositeFeedback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feedbacks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#CompositeFeedback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.CompositeFeedback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A container that executes multiple feedback mechanisms sequentially.
Useful when you want to chain multiple update steps.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If multiple feedbacks share intermediate calculations (e.g., population density),
using CompositeFeedback may result in redundant computations, as each feedback
is applied independently and may recompute shared intermediates. In such cases,
it is more efficient to use a joint update via &#64;model_feedback (i.e., CustomUpdateFeedback),
which allows you to compute shared intermediates only once.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ecx</span><span class="o">.</span><span class="n">function_feedback</span><span class="p">(</span><span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;wage&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wage_update</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="c1"># ... calculation ...</span>
    <span class="k">return</span> <span class="n">new_wage_values</span>

<span class="nd">@ecx</span><span class="o">.</span><span class="n">model_feedback</span> <span class="c1"># Both model_feedback and function_feedback can be used here</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rent_update</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="c1"># ... calculation ...</span>
    <span class="k">return</span> <span class="n">new_model</span>

<span class="n">feedback</span> <span class="o">=</span> <span class="n">CompositeFeedback</span><span class="p">(</span><span class="n">feedbacks</span><span class="o">=</span><span class="p">[</span><span class="n">wage_update</span><span class="p">,</span> <span class="n">rent_update</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feedbacks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><em>FeedbackMechanism</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.feedback.CompositeFeedback.feedbacks">
<span class="sig-name descname"><span class="pre">feedbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code><span class="pre">[</span><a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedbackMechanism</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#econox.logic.feedback.CompositeFeedback.feedbacks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.CompositeFeedback.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#CompositeFeedback.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.CompositeFeedback.update" title="Link to this definition">¶</a></dt>
<dd><p>Sequential application of feedback mechanisms.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>current_result</strong> (<em>Any</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.CompositeFeedback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feedbacks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.feedback.CompositeFeedback.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feedbacks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><em>FeedbackMechanism</em></a><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.feedback.CustomUpdateFeedback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.feedback.</span></span><span class="sig-name descname"><span class="pre">CustomUpdateFeedback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#CustomUpdateFeedback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.CustomUpdateFeedback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A feedback mechanism that allows the user to define a custom function
to update the ENTIRE model structure.</p>
<p>This is the most flexible approach, allowing for complex dependencies
(e.g., wage and rent depending on the same density calculation) without
redundant computations or shape mismatches.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> – A callable with signature (params, result, model) -&gt; StructuralModel.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>func</strong> (<em>Callable</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.feedback.CustomUpdateFeedback.func">
<span class="sig-name descname"><span class="pre">func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#econox.logic.feedback.CustomUpdateFeedback.func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.CustomUpdateFeedback.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#CustomUpdateFeedback.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.CustomUpdateFeedback.update" title="Link to this definition">¶</a></dt>
<dd><p>Delegates the update logic entirely to the user-defined function.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>current_result</strong> (<em>Any</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.CustomUpdateFeedback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.feedback.CustomUpdateFeedback.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>Callable</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="econox.logic.feedback.model_feedback">
<span class="sig-prename descclassname"><span class="pre">econox.logic.feedback.</span></span><span class="sig-name descname"><span class="pre">model_feedback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#model_feedback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.model_feedback" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to register a function as a CustomUpdateFeedback.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ecx</span><span class="o">.</span><span class="n">model_feedback</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_ge_loop</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="c1"># ... calculation ...</span>
    <span class="n">new_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">replace_data</span><span class="p">(</span><span class="s2">&quot;wage&quot;</span><span class="p">,</span> <span class="n">new_wage_values</span><span class="p">)</span>
    <span class="n">new_model</span> <span class="o">=</span> <span class="n">new_model</span><span class="o">.</span><span class="n">replace_data</span><span class="p">(</span><span class="s2">&quot;rent&quot;</span><span class="p">,</span> <span class="n">new_rent_values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_model</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.logic.feedback.CustomUpdateFeedback" title="econox.logic.feedback.CustomUpdateFeedback"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomUpdateFeedback</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>func</strong> (<em>Callable</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.feedback.FunctionFeedback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.feedback.</span></span><span class="sig-name descname"><span class="pre">FunctionFeedback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#FunctionFeedback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.FunctionFeedback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A simpler wrapper for updating a specific key in model.data.
Best for independent, single-variable updates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.feedback.FunctionFeedback.func">
<span class="sig-name descname"><span class="pre">func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#econox.logic.feedback.FunctionFeedback.func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.feedback.FunctionFeedback.target_key">
<span class="sig-name descname"><span class="pre">target_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#econox.logic.feedback.FunctionFeedback.target_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.FunctionFeedback.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#FunctionFeedback.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.FunctionFeedback.update" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>current_result</strong> (<em>Any</em>)</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.feedback.FunctionFeedback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.feedback.FunctionFeedback.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="econox.logic.feedback.function_feedback">
<span class="sig-prename descclassname"><span class="pre">econox.logic.feedback.</span></span><span class="sig-name descname"><span class="pre">function_feedback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/feedback.html#function_feedback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.feedback.function_feedback" title="Link to this definition">¶</a></dt>
<dd><p>Decorator for simple single-variable updates.
Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ecx</span><span class="o">.</span><span class="n">function_feedback</span><span class="p">(</span><span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;wage&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wage_update</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="c1"># ... calculation ...</span>
    <span class="k">return</span> <span class="n">new_wage_values</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <a class="reference internal" href="#econox.logic.feedback.FunctionFeedback" title="econox.logic.feedback.FunctionFeedback"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionFeedback</span></code></a>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>target_key</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-econox.logic.dynamics">
<span id="transition-dynamics"></span><h3>Transition Dynamics<a class="headerlink" href="#module-econox.logic.dynamics" title="Link to this heading">¶</a></h3>
<p>Dynamics logic components for the Econox framework.
Defines how the population/state distribution evolves over time (Law of Motion).</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.dynamics.SimpleDynamics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.dynamics.</span></span><span class="sig-name descname"><span class="pre">SimpleDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_transitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/dynamics.html#SimpleDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.dynamics.SimpleDynamics" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Standard Law of Motion for dynamic models.</p>
<p>Supports two modes:</p>
<ol class="arabic simple">
<li><p>Explicit Transition: <span class="math notranslate nohighlight">\(D_{t+1} = (D_t * P(a|s)) &#64; T(s'|s,a)\)</span>
Used when a transition matrix is provided in the model.</p></li>
<li><p>Direct Mapping: <span class="math notranslate nohighlight">\(D_{t+1} = D_t &#64; P(a|s)\)</span>
Used when no transition matrix is provided.
Assumes Action Space maps 1-to-1 to State Space (A=S).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_transitions</strong> (<em>bool</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.dynamics.SimpleDynamics.use_transitions">
<span class="sig-name descname"><span class="pre">use_transitions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.logic.dynamics.SimpleDynamics.use_transitions" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.dynamics.SimpleDynamics.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_transitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.dynamics.SimpleDynamics.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_transitions</strong> (<em>bool</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.logic.dynamics.TrajectoryDynamics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.logic.dynamics.</span></span><span class="sig-name descname"><span class="pre">TrajectoryDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enforce_boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/logic/dynamics.html#TrajectoryDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.logic.dynamics.TrajectoryDynamics" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Dynamics for solving path-dependent problems (e.g., Rational Expectations).</p>
<p>Handles the evolution of the entire state trajectory over a finite horizon,
often involving:
1. Explicit Transition Matrices (S*A -&gt; S) to handle complex flows.
2. Boundary Conditions (e.g., Fixing t=0 population).</p>
<p>This class expects the following in the model:
- The transition matrix must be accessible via the <cite>transitions</cite> property of the model (i.e., <cite>model.transitions</cite> should return a (S*A, S) matrix defining physical movement).
- “initial_year_indices”: Indices to enforce boundary conditions (in <cite>model.data</cite>).
- “initial_year_values”: Values to enforce at the boundary (in <cite>model.data</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>enforce_boundary</strong> (<em>bool</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.logic.dynamics.TrajectoryDynamics.enforce_boundary">
<span class="sig-name descname"><span class="pre">enforce_boundary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#econox.logic.dynamics.TrajectoryDynamics.enforce_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.logic.dynamics.TrajectoryDynamics.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enforce_boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.logic.dynamics.TrajectoryDynamics.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>enforce_boundary</strong> (<em>bool</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="solvers-algorithms">
<h2>Solvers (Algorithms)<a class="headerlink" href="#solvers-algorithms" title="Link to this heading">¶</a></h2>
<p>Numerical algorithms for solving economic models (Forward Problems).</p>
<section id="module-econox.solvers.dynamic_programming">
<span id="dynamic-programming"></span><h3>Dynamic Programming<a class="headerlink" href="#module-econox.solvers.dynamic_programming" title="Link to this heading">¶</a></h3>
<p>Dynamic programming solver module for economic models.
Can be used for static models as well by setting discount_factor=0.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.solvers.dynamic_programming.</span></span><span class="sig-name descname"><span class="pre">ValueIterationSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discount_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_solver=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/solvers/dynamic_programming.html#ValueIterationSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Fixed-point solver using value function iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility</strong> (<a class="reference internal" href="#econox.protocols.Utility" title="econox.protocols.Utility"><em>Utility</em></a>) – Utility function to compute flow utilities.</p></li>
<li><p><strong>dist</strong> (<a class="reference internal" href="#econox.protocols.Distribution" title="econox.protocols.Distribution"><em>Distribution</em></a>) – Probability distribution for choice modeling.</p></li>
<li><p><strong>discount_factor</strong> (<em>float</em>) – Discount factor for future utilities.</p></li>
<li><p><strong>numerical_solver</strong> – FixedPoint</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>utility</strong> (<a class="reference internal" href="#econox.protocols.Utility" title="econox.protocols.Utility"><em>Utility</em></a>)</p></li>
<li><p><strong>dist</strong> (<a class="reference internal" href="#econox.protocols.Distribution" title="econox.protocols.Distribution"><em>Distribution</em></a>)</p></li>
<li><p><strong>discount_factor</strong> (<em>float</em>)</p></li>
<li><p><strong>numerical_solver</strong> (<a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><em>FixedPoint</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optional Data Keys:</dt><dd><p>The solver looks for the following keys in <cite>model.data</cite> to enable
terminal state approximation (<span class="math notranslate nohighlight">\(EV(T-1) = EV(T)\)</span>):</p>
<ul class="simple">
<li><p><strong>terminal_state_indices</strong> (Int[Array, “n”]): Indices of states at <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
<li><p><strong>previous_state_indices</strong> (Int[Array, “n”]): Indices of states at <span class="math notranslate nohighlight">\(T-1\)</span> to copy from.</p></li>
</ul>
<p>If provided, both must be present and have the same shape.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define structural components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utility</span> <span class="o">=</span> <span class="n">MyUtilityFunction</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Type1ExtremeValue</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize solver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">ValueIterationSolver</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">utility</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">discount_factor</span><span class="o">=</span><span class="mf">0.99</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EV</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">solution</span>  <span class="c1"># Expected Value Function EV(s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">profile</span>    <span class="c1"># Choice Probabilities P(a|s)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.utility">
<span class="sig-name descname"><span class="pre">utility</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.Utility" title="econox.protocols.Utility"><code class="xref py py-class docutils literal notranslate"><span class="pre">Utility</span></code></a></em><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.utility" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.dist">
<span class="sig-name descname"><span class="pre">dist</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.Distribution" title="econox.protocols.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></em><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.dist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.discount_factor">
<span class="sig-name descname"><span class="pre">discount_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.discount_factor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.numerical_solver">
<span class="sig-name descname"><span class="pre">numerical_solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedPoint</span></code></a></em><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.numerical_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/solvers/dynamic_programming.html#ValueIterationSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Solves for the fixed point of the structural model using value iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>) – Model parameters.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>) – The structural model instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The result of the solver containing the solution and additional information containing:</p>
<ul class="simple">
<li><p><strong>solution</strong> (Array): The computed Expected Value Function <span class="math notranslate nohighlight">\(EV(s)\)</span> (Integrated Value Function / Emax).</p></li>
<li><p><strong>profile</strong> (Array): The Conditional Choice Probabilities (CCP) <span class="math notranslate nohighlight">\(P(a|s)\)</span> derived from the value function.</p></li>
<li><p><strong>success</strong> (Bool): Whether the solver converged successfully.</p></li>
<li><p><strong>aux</strong> (Dict): Auxiliary information, including number of steps taken.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult">SolverResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.solvers.dynamic_programming.ValueIterationSolver.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utility</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discount_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_solver=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.solvers.dynamic_programming.ValueIterationSolver.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utility</strong> (<a class="reference internal" href="#econox.protocols.Utility" title="econox.protocols.Utility"><em>Utility</em></a>)</p></li>
<li><p><strong>dist</strong> (<a class="reference internal" href="#econox.protocols.Distribution" title="econox.protocols.Distribution"><em>Distribution</em></a>)</p></li>
<li><p><strong>discount_factor</strong> (<em>float</em>)</p></li>
<li><p><strong>numerical_solver</strong> (<a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><em>FixedPoint</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.solvers.equilibrium">
<span id="equilibrium-solvers"></span><h3>Equilibrium Solvers<a class="headerlink" href="#module-econox.solvers.equilibrium" title="Link to this heading">¶</a></h3>
<p>Equilibrium solver module for dynamic economic models.
Can be used for static models as well by setting discount_factor=0.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.solvers.equilibrium.</span></span><span class="sig-name descname"><span class="pre">EquilibriumSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inner_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feedback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_solver=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_distribution=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/solvers/equilibrium.html#EquilibriumSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Fixed-point solver for General Equilibrium (GE) or Stationary Equilibrium.</p>
<p>This solver searches for a distribution of agents (or prices) <span class="math notranslate nohighlight">\(D^*\)</span> such that:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[D^* = \Phi(D^*, \theta)\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> represents the compound operator of:
1. Updating the environment (Feedback): <span class="math notranslate nohighlight">\(\Omega' = \Gamma(D, \Omega)\)</span>
2. Solving the agent’s problem (Inner Solver): <span class="math notranslate nohighlight">\(\sigma^* = \text{argmax} \, V(s; \Omega')\)</span>
3. Applying the law of motion (Dynamics): <span class="math notranslate nohighlight">\(D' = f(D, \sigma^*)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inner_solver</strong> (<a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><em>Solver</em></a>) – The solver used to compute the optimal policy given a fixed environment.</p></li>
<li><p><strong>feedback</strong> (<a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><em>FeedbackMechanism</em></a>) – Logic to update model data based on aggregate results.</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#econox.protocols.Dynamics" title="econox.protocols.Dynamics"><em>Dynamics</em></a>) – Law of motion describing how the distribution evolves.</p></li>
<li><p><strong>numerical_solver</strong> (<a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><em>FixedPoint</em></a>) – The numerical algorithm for the outer loop (e.g., Anderson Acceleration).</p></li>
<li><p><strong>damping</strong> (<em>float</em>) – Damping factor for the update step <span class="math notranslate nohighlight">\(D_{k+1} = (1-\lambda)D_k + \lambda D_{new}\)</span>.</p></li>
<li><p><strong>initial_distribution</strong> (<em>Array</em><em> | </em><em>None</em>) – Initial guess for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>inner_solver</strong> (<a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><em>Solver</em></a>)</p></li>
<li><p><strong>feedback</strong> (<a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><em>FeedbackMechanism</em></a>)</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#econox.protocols.Dynamics" title="econox.protocols.Dynamics"><em>Dynamics</em></a>)</p></li>
<li><p><strong>numerical_solver</strong> (<a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><em>FixedPoint</em></a>)</p></li>
<li><p><strong>damping</strong> (<em>float</em>)</p></li>
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1. Inner agent problem (e.g., Household optimization)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inner_solver</span> <span class="o">=</span> <span class="n">ValueIterationSolver</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2. Market clearing logic (e.g., Supply = Demand)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feedback</span> <span class="o">=</span> <span class="n">FunctionFeedback</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">WageFeedback</span><span class="p">,</span> <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;wage&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3. Dynamics (Law of Motion)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dynamics</span> <span class="o">=</span> <span class="n">SimpleDynamics</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 4. Equilibrium Solver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq_solver</span> <span class="o">=</span> <span class="n">EquilibriumSolver</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">inner_solver</span><span class="o">=</span><span class="n">inner_solver</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">feedback</span><span class="o">=</span><span class="n">feedback</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">damping</span><span class="o">=</span><span class="mf">0.5</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve for stationary equilibrium</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">eq_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.inner_solver">
<span class="sig-name descname"><span class="pre">inner_solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.inner_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.feedback">
<span class="sig-name descname"><span class="pre">feedback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeedbackMechanism</span></code></a></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.feedback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.dynamics">
<span class="sig-name descname"><span class="pre">dynamics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.protocols.Dynamics" title="econox.protocols.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dynamics</span></code></a></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.dynamics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.numerical_solver">
<span class="sig-name descname"><span class="pre">numerical_solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedPoint</span></code></a></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.numerical_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.damping">
<span class="sig-name descname"><span class="pre">damping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.damping" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'num_states']</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.initial_distribution" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/solvers/equilibrium.html#EquilibriumSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Solves for the fixed point of the structural model using equilibrium conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>) – Model parameters.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><em>StructuralModel</em></a>) – The structural model instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The result object containing:</p>
<ul class="simple">
<li><p><strong>solution</strong>: Equilibrium Distribution <span class="math notranslate nohighlight">\(D^*\)</span></p></li>
<li><p><strong>profile</strong>: Equilibrium Policy <span class="math notranslate nohighlight">\(P^*\)</span></p></li>
<li><p><strong>inner_result</strong>: Full result from the inner solver (Value Function etc.)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.structures.results.SolverResult" title="econox.structures.results.SolverResult">SolverResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.solvers.equilibrium.EquilibriumSolver.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inner_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feedback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_solver=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_distribution=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.solvers.equilibrium.EquilibriumSolver.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inner_solver</strong> (<a class="reference internal" href="#econox.protocols.Solver" title="econox.protocols.Solver"><em>Solver</em></a>)</p></li>
<li><p><strong>feedback</strong> (<a class="reference internal" href="#econox.protocols.FeedbackMechanism" title="econox.protocols.FeedbackMechanism"><em>FeedbackMechanism</em></a>)</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#econox.protocols.Dynamics" title="econox.protocols.Dynamics"><em>Dynamics</em></a>)</p></li>
<li><p><strong>numerical_solver</strong> (<a class="reference internal" href="#econox.optim.FixedPoint" title="econox.optim.FixedPoint"><em>FixedPoint</em></a>)</p></li>
<li><p><strong>damping</strong> (<em>float</em>)</p></li>
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="optimization-backends">
<h3>Optimization Backends<a class="headerlink" href="#optimization-backends" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Import Note</strong>: This module is not exposed in the top-level <code class="docutils literal notranslate"><span class="pre">econox</span></code> namespace.
You must access it via the submodule:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">econox.optim</span><span class="w"> </span><span class="kn">import</span> <span class="n">Minimizer</span>
<span class="c1"># or</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">econox.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
</pre></div>
</div>
</div>
<p id="module-econox.optim">Optimization and Fixed-Point strategies using Optimistix.
Wraps numerical solvers to provide a consistent interface for Econox components.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.optim.</span></span><span class="sig-name descname"><span class="pre">MinimizerResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#MinimizerResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.MinimizerResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A generic container for optimization results.
Decouples the Estimator from the specific backend (optimistix/jaxopt).</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – The optimized parameters (PyTree).</p></li>
<li><p><strong>loss</strong> – The final loss value (Scalar).</p></li>
<li><p><strong>success</strong> – Whether the optimization was successful (Bool).</p></li>
<li><p><strong>steps</strong> – Number of optimization steps taken (Int).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>loss</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>steps</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></em><a class="headerlink" href="#econox.optim.MinimizerResult.params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code></em><a class="headerlink" href="#econox.optim.MinimizerResult.loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult.success">
<span class="sig-name descname"><span class="pre">success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Bool[Array,</span> <span class="pre">'']</span></code></em><a class="headerlink" href="#econox.optim.MinimizerResult.success" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array,</span> <span class="pre">'']</span></code></em><a class="headerlink" href="#econox.optim.MinimizerResult.steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.MinimizerResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.optim.MinimizerResult.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>loss</strong> (<em>Shaped</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>steps</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.optim.Minimizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.optim.</span></span><span class="sig-name descname"><span class="pre">Minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method=LBFGS(</span>&#160;&#160; <span class="pre">rtol=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm=&lt;function</span> <span class="pre">max_norm&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inverse=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descent=NewtonDescent()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search=BacktrackingArmijo()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_length=10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=frozenset()</span> <span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps=1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throw=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#Minimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.Minimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Wrapper for optimistix.minimise.
Implements the econox.protocols.Optimizer interface.</p>
<p>You can customize the method and tolerances at initialization.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default (LBFGS, tol=1e-6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Custom method (e.g., Nelder-Mead) and tolerances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">optx</span><span class="o">.</span><span class="n">NelderMead</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>AbstractMinimiser</em>)</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>throw</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.Minimizer.method">
<span class="sig-name descname"><span class="pre">method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMinimiser</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">LBFGS(</span>&#160;&#160; <span class="pre">rtol=1e-06,</span>&#160;&#160; <span class="pre">atol=1e-06,</span>&#160;&#160; <span class="pre">norm=&lt;function</span> <span class="pre">max_norm&gt;,</span>&#160;&#160; <span class="pre">use_inverse=True,</span>&#160;&#160; <span class="pre">descent=NewtonDescent(),</span>&#160;&#160; <span class="pre">search=BacktrackingArmijo(),</span>&#160;&#160; <span class="pre">history_length=10,</span>&#160;&#160; <span class="pre">verbose=frozenset()</span> <span class="pre">)</span></em><a class="headerlink" href="#econox.optim.Minimizer.method" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.Minimizer.max_steps">
<span class="sig-name descname"><span class="pre">max_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#econox.optim.Minimizer.max_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.Minimizer.throw">
<span class="sig-name descname"><span class="pre">throw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.optim.Minimizer.throw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.Minimizer.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#Minimizer.minimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.Minimizer.minimize" title="Link to this definition">¶</a></dt>
<dd><p>Minimizes the loss function using the specified method and tolerances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>PyTree</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>Scalar</em><em>]</em>) – The loss function to minimize.
Takes parameters and additional arguments, returns a scalar loss.</p></li>
<li><p><strong>init_params</strong> (<em>PyTree</em>) – Initial parameter values for optimization.</p></li>
<li><p><strong>args</strong> (<em>Any</em><em>, </em><em>optional</em>) – Additional arguments passed to the loss function.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains the optimized parameters, final loss,
success status, and iteration count.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.optim.MinimizerResult" title="econox.optim.MinimizerResult">MinimizerResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.Minimizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method=LBFGS(</span>&#160;&#160; <span class="pre">rtol=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol=1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm=&lt;function</span> <span class="pre">max_norm&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inverse=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descent=NewtonDescent()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search=BacktrackingArmijo()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_length=10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=frozenset()</span> <span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps=1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throw=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.optim.Minimizer.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>AbstractMinimiser</em>)</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>throw</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.optim.FixedPointResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.optim.</span></span><span class="sig-name descname"><span class="pre">FixedPointResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#FixedPointResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.FixedPointResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Container for fixed-point computation results.
Used by internal solvers (Bellman, Equilibrium) to report convergence status.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – The computed fixed-point value (PyTree).</p></li>
<li><p><strong>success</strong> – Whether the fixed-point iteration was successful (Bool).</p></li>
<li><p><strong>steps</strong> – Number of iterations taken (Int).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>value</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>steps</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPointResult.value">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></em><a class="headerlink" href="#econox.optim.FixedPointResult.value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPointResult.success">
<span class="sig-name descname"><span class="pre">success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Bool[Array,</span> <span class="pre">'']</span></code></em><a class="headerlink" href="#econox.optim.FixedPointResult.success" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPointResult.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array,</span> <span class="pre">'']</span></code></em><a class="headerlink" href="#econox.optim.FixedPointResult.steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.FixedPointResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">success</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.optim.FixedPointResult.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>PyTree</em>)</p></li>
<li><p><strong>success</strong> (<em>Bool</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
<li><p><strong>steps</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.optim.FixedPoint">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.optim.</span></span><span class="sig-name descname"><span class="pre">FixedPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">FixedPointIteration(rtol=1e-08,</span> <span class="pre">atol=1e-08)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ImplicitAdjoint(linear_solver=AutoLinearSolver(well_posed=False))</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#FixedPoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.FixedPoint" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Wrapper for optimistix.fixed_point.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default (FixedPointIteration)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Uses default max_steps (2000) and tolerances (rtol=1e-8, atol=1e-8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="n">FixedPoint</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Custom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="n">FixedPoint</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">optx</span><span class="o">.</span><span class="n">FixedPointIteration</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">),</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>AbstractFixedPointSolver</em>)</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>throw</strong> (<em>bool</em>)</p></li>
<li><p><strong>adjoint</strong> (<em>AbstractAdjoint</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.method">
<span class="sig-name descname"><span class="pre">method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFixedPointSolver</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">FixedPointIteration(rtol=1e-08,</span> <span class="pre">atol=1e-08)</span></em><a class="headerlink" href="#econox.optim.FixedPoint.method" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.max_steps">
<span class="sig-name descname"><span class="pre">max_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2000</span></em><a class="headerlink" href="#econox.optim.FixedPoint.max_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.throw">
<span class="sig-name descname"><span class="pre">throw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.optim.FixedPoint.throw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractAdjoint</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">ImplicitAdjoint(linear_solver=AutoLinearSolver(well_posed=False))</span></em><a class="headerlink" href="#econox.optim.FixedPoint.adjoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.find_fixed_point">
<span class="sig-name descname"><span class="pre">find_fixed_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/optim.html#FixedPoint.find_fixed_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.optim.FixedPoint.find_fixed_point" title="Link to this definition">¶</a></dt>
<dd><p>Solves for <span class="math notranslate nohighlight">\(y\)</span> such that <span class="math notranslate nohighlight">\(y = \text{step\_fn}(y, \text{args})\)</span>.
Returns a FixedPointResult containing the solution and status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>PyTree</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>PyTree</em><em>]</em>) – The fixed-point function. Takes current value and args, returns next value.</p></li>
<li><p><strong>init_val</strong> (<em>PyTree</em>) – Initial guess for the fixed-point iteration.</p></li>
<li><p><strong>args</strong> (<em>Any</em><em>, </em><em>optional</em>) – Additional arguments passed to the fixed-point function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains the fixed-point value, success status, and iteration count.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.optim.FixedPointResult" title="econox.optim.FixedPointResult">FixedPointResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.optim.FixedPoint.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">FixedPointIteration(rtol=1e-08,</span> <span class="pre">atol=1e-08)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ImplicitAdjoint(linear_solver=AutoLinearSolver(well_posed=False))</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.optim.FixedPoint.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>AbstractFixedPointSolver</em>)</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>throw</strong> (<em>bool</em>)</p></li>
<li><p><strong>adjoint</strong> (<em>AbstractAdjoint</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="methods-estimation-techniques">
<h2>Methods (Estimation Techniques)<a class="headerlink" href="#methods-estimation-techniques" title="Link to this heading">¶</a></h2>
<p>Strategies for estimating model parameters from data (Inverse Problems).</p>
<section id="module-econox.methods.base">
<span id="base-classes"></span><h3>Base Classes<a class="headerlink" href="#module-econox.methods.base" title="Link to this heading">¶</a></h3>
<p>Base module for method functions in the Econox framework.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.base.</span></span><span class="sig-name descname"><span class="pre">EstimationMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/base.html#EstimationMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.base.EstimationMethod" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Base class for all estimation method functions in Econox.</p>
<p>This class serves three main purposes:
1. <strong>Strategy Definition</strong>: Defines the loss function to be minimized during numerical estimation.
2. <strong>Analytical Solution</strong>: Optionally provides a direct solution method (e.g., for OLS/2SLS).
3. <strong>Inference</strong>: Optionally defines how to calculate standard errors (e.g., Hessian, Sandwich).</p>
<p>Users can create custom objectives by subclassing this class or by using the
<cite>&#64;method_from_loss</cite> decorator.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>variance</strong> – Variance | None</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variance</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.base.EstimationMethod.variance" title="Link to this definition">¶</a></dt>
<dd><p>Optional variance calculation strategy for inference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod.compute_loss">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/base.html#EstimationMethod.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.base.EstimationMethod.compute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scalar loss metric to be minimized.</p>
<p>This method is the core of the numerical estimation loop. It compares the
model’s prediction (<cite>result</cite>) with the real-world data (<cite>observations</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The output from the Solver (e.g., <cite>SolverResult</cite>).
If an analytical solution is being evaluated, this may be None.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to fit the model against.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Current model parameters (useful for regularization terms).</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A scalar JAX array representing the loss (e.g., Negative Log-Likelihood).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/base.html#EstimationMethod.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.base.EstimationMethod.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes the analytical solution for the parameters, if available.</p>
<p>This method allows the <cite>Estimator</cite> to bypass the numerical optimization loop
for models that have a closed-form solution (e.g., OLS, 2SLS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data.</p></li>
<li><p><strong>param_space</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The parameter space definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns an <code class="docutils literal notranslate"><span class="pre">EstimationResult</span></code> if an analytical solution is found.
Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise (default), and the Estimator will fall back
to numerical optimization using <cite>compute_loss</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#econox.structures.results.EstimationResult" title="econox.structures.results.EstimationResult">EstimationResult</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod.from_function">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/base.html#EstimationMethod.from_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.base.EstimationMethod.from_function" title="Link to this definition">¶</a></dt>
<dd><p>Creates an <cite>EstimationMethod</cite> instance from a simple loss function.</p>
<p>This factory method allows users to define objectives using a simple function
instead of defining a full class. The created objective will rely on numerical
optimization (solve returns None) and will not compute standard errors by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span>) – A function with the signature:
<cite>(result, observations, params, model) -&gt; Scalar</cite></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of a dynamically created <cite>EstimationMethod</cite> subclass.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@method_from_loss</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">mse_loss</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">result</span><span class="o">.</span><span class="n">solution</span> <span class="o">-</span> <span class="n">observations</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.base.EstimationMethod.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.base.EstimationMethod.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="econox.methods.base.method_from_loss">
<span class="sig-prename descclassname"><span class="pre">econox.methods.base.</span></span><span class="sig-name descname"><span class="pre">method_from_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.base.method_from_loss" title="Link to this definition">¶</a></dt>
<dd><p>Creates an <cite>EstimationMethod</cite> instance from a simple loss function.</p>
<p>This factory method allows users to define objectives using a simple function
instead of defining a full class. The created objective will rely on numerical
optimization (solve returns None) and will not compute standard errors by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span>) – A function with the signature:
<cite>(result, observations, params, model) -&gt; Scalar</cite></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of a dynamically created <cite>EstimationMethod</cite> subclass.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@method_from_loss</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">mse_loss</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">result</span><span class="o">.</span><span class="n">solution</span> <span class="o">-</span> <span class="n">observations</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-econox.methods.analytical">
<span id="analytical-methods-ols-2sls"></span><h3>Analytical Methods (OLS/2SLS)<a class="headerlink" href="#module-econox.methods.analytical" title="Link to this heading">¶</a></h3>
<p>Analytical linear estimation methods (OLS, 2SLS) with fixed parameter support.</p>
<p>This module provides:
- OLS (Ordinary Least Squares)
- 2SLS (Two-Stage Least Squares)</p>
<p>Both support:
- Fixed parameter constraints
- Numerical stability via QR decomposition
- Automatic fallback to numerical optimization for complex constraints</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ols</span> <span class="o">=</span> <span class="n">LeastSquares</span><span class="p">(</span><span class="n">feature_key</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use Estimator (Recommended)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">est</span> <span class="o">=</span> <span class="n">Estimator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">param_space</span><span class="o">=</span><span class="n">param_space</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">ols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">observations</span><span class="o">=</span><span class="n">observations</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or call solve() directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ols</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">observations</span><span class="o">=</span><span class="n">observations</span><span class="p">,</span> <span class="n">param_space</span><span class="o">=</span><span class="n">param_space</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.analytical.</span></span><span class="sig-name descname"><span class="pre">AnalyticalParameterHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_fixed_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_values_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_free</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#AnalyticalParameterHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Handles fixed parameter constraints for analytical linear methods.</p>
<p>This handler:
- Separates fixed and free parameters
- Transforms design matrices to account for fixed values
- Reconstructs full parameter vectors and covariance matrices</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_fixed_mask</strong> – Boolean mask (True = fixed, False = free)</p></li>
<li><p><strong>fixed_values_vec</strong> – Values for fixed parameters</p></li>
<li><p><strong>param_names</strong> – Names of all parameters</p></li>
<li><p><strong>n_total</strong> – Total number of parameters</p></li>
<li><p><strong>n_fixed</strong> – Number of fixed parameters</p></li>
<li><p><strong>n_free</strong> – Number of free parameters (n_total - n_fixed)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>is_fixed_mask</strong> (<em>Array</em>)</p></li>
<li><p><strong>fixed_values_vec</strong> (<em>Array</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>n_total</strong> (<em>int</em>)</p></li>
<li><p><strong>n_fixed</strong> (<em>int</em>)</p></li>
<li><p><strong>n_free</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.is_fixed_mask">
<span class="sig-name descname"><span class="pre">is_fixed_mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.is_fixed_mask" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.fixed_values_vec">
<span class="sig-name descname"><span class="pre">fixed_values_vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.fixed_values_vec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.param_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.n_total">
<span class="sig-name descname"><span class="pre">n_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.n_total" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.n_fixed">
<span class="sig-name descname"><span class="pre">n_fixed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.n_fixed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.n_free">
<span class="sig-name descname"><span class="pre">n_free</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.n_free" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.from_params">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#AnalyticalParameterHandler.from_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.from_params" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler" title="econox.methods.analytical.AnalyticalParameterHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnalyticalParameterHandler</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>param_space</strong> (<a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><em>ParameterSpace</em></a>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#AnalyticalParameterHandler.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.transform" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>X</strong> (<em>Array</em>)</p></li>
<li><p><strong>y</strong> (<em>Array</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcov_free</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#AnalyticalParameterHandler.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.reconstruct" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>beta_free</strong> (<em>Array</em>)</p></li>
<li><p><strong>vcov_free</strong> (<em>Array</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.AnalyticalParameterHandler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_fixed_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_values_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_free</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.analytical.AnalyticalParameterHandler.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_fixed_mask</strong> (<em>Array</em>)</p></li>
<li><p><strong>fixed_values_vec</strong> (<em>Array</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>n_total</strong> (<em>int</em>)</p></li>
<li><p><strong>n_fixed</strong> (<em>int</em>)</p></li>
<li><p><strong>n_free</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.analytical.</span></span><span class="sig-name descname"><span class="pre">LinearMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#LinearMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.LinearMethod" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></p>
<p>Base class providing the template method for analytical solving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.add_intercept">
<span class="sig-name descname"><span class="pre">add_intercept</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#econox.methods.analytical.LinearMethod.add_intercept" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.target_key">
<span class="sig-name descname"><span class="pre">target_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'y'</span></em><a class="headerlink" href="#econox.methods.analytical.LinearMethod.target_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.analytical.LinearMethod.param_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#LinearMethod.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.LinearMethod.solve" title="Link to this definition">¶</a></dt>
<dd><p>Analytical estimation workflow with fixed parameter support.</p>
<dl class="simple">
<dt>Workflow:</dt><dd><ol class="arabic simple">
<li><p>Data Preparation: Extract y, construct X (and Z for 2SLS)</p></li>
<li><p>Constraint Handling: Separate fixed/free parameters</p></li>
<li><p>Core Estimation: Subclass-specific OLS/2SLS logic</p></li>
<li><p>Reconstruction: Merge fixed and estimated parameters</p></li>
<li><p>Statistics: Compute residuals, R², standard errors</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – Structural model containing data</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observation data (used to extract target y)</p></li>
<li><p><strong>param_space</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.structures.params.ParameterSpace" title="econox.structures.params.ParameterSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterSpace</span></code></a></span>) – Parameter space with constraints and initial values</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.structures.results.EstimationResult" title="econox.structures.results.EstimationResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationResult</span></code></a> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>EstimationResult if successful, None if fallback to numerical needed</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>loss: The Sum of Squared Residuals (SSR).</dt><dd><p>Note that this is the total sum, not the mean (MSE).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns None when constraints other than ‘fixed’/’free’ are present,
signaling Estimator to use numerical optimization instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#LinearMethod.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.LinearMethod.compute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scalar loss metric to be minimized.</p>
<p>This method is the core of the numerical estimation loop. It compares the
model’s prediction (<cite>result</cite>) with the real-world data (<cite>observations</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The output from the Solver (e.g., <cite>SolverResult</cite>).
If an analytical solution is being evaluated, this may be None.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to fit the model against.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Current model parameters (useful for regularization terms).</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A scalar JAX array representing the loss (e.g., Negative Log-Likelihood).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.LinearMethod.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.analytical.LinearMethod.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.analytical.LeastSquares">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.analytical.</span></span><span class="sig-name descname"><span class="pre">LeastSquares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key='X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#LeastSquares"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.LeastSquares" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.analytical.LinearMethod" title="econox.methods.analytical.LinearMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearMethod</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>feature_key</strong> (<em>str</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.LeastSquares.feature_key">
<span class="sig-name descname"><span class="pre">feature_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'X'</span></em><a class="headerlink" href="#econox.methods.analytical.LeastSquares.feature_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.LeastSquares.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_key='X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.analytical.LeastSquares.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>feature_key</strong> (<em>str</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.analytical.TwoStageLeastSquares">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.analytical.</span></span><span class="sig-name descname"><span class="pre">TwoStageLeastSquares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endog_key='X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument_key='Z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controls_key=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/analytical.html#TwoStageLeastSquares"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.analytical.TwoStageLeastSquares" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.analytical.LinearMethod" title="econox.methods.analytical.LinearMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearMethod</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>endog_key</strong> (<em>str</em>)</p></li>
<li><p><strong>instrument_key</strong> (<em>str</em>)</p></li>
<li><p><strong>controls_key</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.TwoStageLeastSquares.endog_key">
<span class="sig-name descname"><span class="pre">endog_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'X'</span></em><a class="headerlink" href="#econox.methods.analytical.TwoStageLeastSquares.endog_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.TwoStageLeastSquares.instrument_key">
<span class="sig-name descname"><span class="pre">instrument_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Z'</span></em><a class="headerlink" href="#econox.methods.analytical.TwoStageLeastSquares.instrument_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.analytical.TwoStageLeastSquares.controls_key">
<span class="sig-name descname"><span class="pre">controls_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.analytical.TwoStageLeastSquares.controls_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.analytical.TwoStageLeastSquares.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_intercept=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_key='y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endog_key='X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument_key='Z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controls_key=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.analytical.TwoStageLeastSquares.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_intercept</strong> (<em>bool</em>)</p></li>
<li><p><strong>target_key</strong> (<em>str</em>)</p></li>
<li><p><strong>param_names</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>endog_key</strong> (<em>str</em>)</p></li>
<li><p><strong>instrument_key</strong> (<em>str</em>)</p></li>
<li><p><strong>controls_key</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.methods.numerical">
<span id="numerical-methods-mle-gmm"></span><h3>Numerical Methods (MLE/GMM)<a class="headerlink" href="#module-econox.methods.numerical" title="Link to this heading">¶</a></h3>
<p>Numerical estimation methods (loss-based).
Standard methods like Maximum Likelihood (MLE) and GMM.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.numerical.</span></span><span class="sig-name descname"><span class="pre">CompositeMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#CompositeMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.CompositeMethod" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></p>
<p>Combines multiple estimation methods into a single scalar loss.
Assumes methods are independent (Block-Diagonal Weighting).</p>
<p>Loss = sum( weight_i * loss_i )</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>methods</strong> – Sequence[EstimationMethod]</p></li>
<li><p><strong>weights</strong> – Sequence[float] | None
Optional weights for each method. If None, equal weights are used.</p></li>
<li><p><strong>variance</strong> – Variance | None
Optional variance calculation strategy for inference.
Note: By default, variance is not computed for composite methods because
the combined loss may not correspond to a valid statistical model.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>methods</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><em>EstimationMethod</em></a><em>]</em>)</p></li>
<li><p><strong>weights</strong> (<em>Sequence</em><em>[</em><em>float</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod.methods">
<span class="sig-name descname"><span class="pre">methods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code><span class="pre">[</span><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#econox.methods.numerical.CompositeMethod.methods" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.numerical.CompositeMethod.weights" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variance</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.numerical.CompositeMethod.variance" title="Link to this definition">¶</a></dt>
<dd><p>Optional variance calculation strategy for inference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#CompositeMethod.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.CompositeMethod.compute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scalar loss metric to be minimized.</p>
<p>This method is the core of the numerical estimation loop. It compares the
model’s prediction (<cite>result</cite>) with the real-world data (<cite>observations</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The output from the Solver (e.g., <cite>SolverResult</cite>).
If an analytical solution is being evaluated, this may be None.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to fit the model against.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Current model parameters (useful for regularization terms).</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A scalar JAX array representing the loss (e.g., Negative Log-Likelihood).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.CompositeMethod.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.numerical.CompositeMethod.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>methods</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><em>EstimationMethod</em></a><em>]</em>)</p></li>
<li><p><strong>weights</strong> (<em>Sequence</em><em>[</em><em>float</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.numerical.MaximumLikelihood">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.numerical.</span></span><span class="sig-name descname"><span class="pre">MaximumLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">choice_probs_key='profile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#MaximumLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.MaximumLikelihood" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></p>
<p>Standard MLE for Discrete Choice (Migration/Occupation).
Computes Negative Log-Likelihood (NLL) based on choice probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>choice_probs_key</strong> (<em>str</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.MaximumLikelihood.choice_probs_key">
<span class="sig-name descname"><span class="pre">choice_probs_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'profile'</span></em><a class="headerlink" href="#econox.methods.numerical.MaximumLikelihood.choice_probs_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.MaximumLikelihood.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#MaximumLikelihood.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.MaximumLikelihood.compute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scalar loss metric to be minimized.</p>
<p>This method is the core of the numerical estimation loop. It compares the
model’s prediction (<cite>result</cite>) with the real-world data (<cite>observations</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The output from the Solver (e.g., <cite>SolverResult</cite>).
If an analytical solution is being evaluated, this may be None.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to fit the model against.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Current model parameters (useful for regularization terms).</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A scalar JAX array representing the loss (e.g., Negative Log-Likelihood).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.MaximumLikelihood.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">choice_probs_key='profile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.numerical.MaximumLikelihood.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>choice_probs_key</strong> (<em>str</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.numerical.</span></span><span class="sig-name descname"><span class="pre">GaussianMomentMatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_param_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#GaussianMomentMatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.base.EstimationMethod" title="econox.methods.base.EstimationMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a></p>
<p>Fits a continuous model variable (e.g. Rent, Wage) to observed data
assuming a Gaussian (or Log-Normal) error structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_key</strong> (<em>str</em>)</p></li>
<li><p><strong>model_key</strong> (<em>str</em>)</p></li>
<li><p><strong>scale_param_key</strong> (<em>str</em>)</p></li>
<li><p><strong>log_transform</strong> (<em>bool</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.obs_key">
<span class="sig-name descname"><span class="pre">obs_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.obs_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.model_key">
<span class="sig-name descname"><span class="pre">model_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.model_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.scale_param_key">
<span class="sig-name descname"><span class="pre">scale_param_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.scale_param_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.log_transform">
<span class="sig-name descname"><span class="pre">log_transform</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.log_transform" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variance</span></code></a> <span class="pre">|</span> <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.variance" title="Link to this definition">¶</a></dt>
<dd><p>Optional variance calculation strategy for inference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_param_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_key</strong> (<em>str</em>)</p></li>
<li><p><strong>model_key</strong> (<em>str</em>)</p></li>
<li><p><strong>scale_param_key</strong> (<em>str</em>)</p></li>
<li><p><strong>log_transform</strong> (<em>bool</em>)</p></li>
<li><p><strong>variance</strong> (<a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><em>Variance</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.numerical.GaussianMomentMatch.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/numerical.html#GaussianMomentMatch.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.numerical.GaussianMomentMatch.compute_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the scalar loss metric to be minimized.</p>
<p>This method is the core of the numerical estimation loop. It compares the
model’s prediction (<cite>result</cite>) with the real-world data (<cite>observations</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The output from the Solver (e.g., <cite>SolverResult</cite>).
If an analytical solution is being evaluated, this may be None.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – Observed data to fit the model against.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – Current model parameters (useful for regularization terms).</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#econox.protocols.StructuralModel" title="econox.protocols.StructuralModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralModel</span></code></a></span>) – The structural model environment.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A scalar JAX array representing the loss (e.g., Negative Log-Likelihood).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-econox.methods.variance">
<span id="variance-inference"></span><h3>Variance &amp; Inference<a class="headerlink" href="#module-econox.methods.variance" title="Link to this heading">¶</a></h3>
<p>Variance calculation strategies for statistical inference.
Handles the computation of standard errors and covariance matrices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.variance.Variance">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.variance.</span></span><span class="sig-name descname"><span class="pre">Variance</span></span><a class="reference internal" href="_modules/econox/methods/variance.html#Variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.variance.Variance" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Base class for variance computation strategies.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.variance.Variance.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_observations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/variance.html#Variance.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.variance.Variance.compute" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the standard errors and variance-covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fn</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code>]</span>) – A differentiable function <cite>f(params) -&gt; loss</cite>.
The objective function with <cite>result</cite> and <cite>model</cite> applied via closure.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – The estimated optimal parameters.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The observed data.</p></li>
<li><p><strong>num_observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of data points (N).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>std_errors: PyTree of standard errors (same structure as params).</p></li>
<li><p>vcov: Variance-covariance matrix (n_params x n_params).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.variance.Variance.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.variance.Variance.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="econox.methods.variance.Hessian">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">econox.methods.variance.</span></span><span class="sig-name descname"><span class="pre">Hessian</span></span><a class="reference internal" href="_modules/econox/methods/variance.html#Hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.variance.Hessian" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#econox.methods.variance.Variance" title="econox.methods.variance.Variance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Variance</span></code></a></p>
<p>Calculates variance using the inverse Hessian of the loss function.</p>
<p>Standard approach for Maximum Likelihood Estimation (MLE).
Assumes the loss function is the negative log-likelihood.
<span class="math notranslate nohighlight">\(V = H^{-1} / N\)</span></p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.variance.Hessian.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_observations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/methods/variance.html#Hessian.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.methods.variance.Hessian.compute" title="Link to this definition">¶</a></dt>
<dd><p>Calculates standard errors and variance-covariance matrix using the Hessian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fn</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Shaped[Array,</span> <span class="pre">'']</span></code>]</span>) – A differentiable function <cite>f(params) -&gt; loss</cite>.</p></li>
<li><p><strong>params</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTree</span></code></span>) – The estimated optimal parameters.</p></li>
<li><p><strong>observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The observed data.</p></li>
<li><p><strong>num_observations</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of data points (N).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:</p>
<ul class="simple">
<li><p><strong>std_errors</strong>: Standard errors matching the structure of the input <cite>params</cite>.
(If input params are flattened, this will be a 1D array)</p></li>
<li><p><strong>vcov</strong>: Variance-covariance matrix.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="econox.methods.variance.Hessian.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#econox.methods.variance.Hessian.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Import Note</strong>: Configuration constants are located in the <code class="docutils literal notranslate"><span class="pre">econox.config</span></code> submodule.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">econox</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>
<span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">NUMERICAL_EPSILON</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Global settings and constants used throughout the library.</p>
<p id="module-econox.config">Global configuration defaults for Econox.</p>
<dl class="py data">
<dt class="sig sig-object py" id="econox.config.INLINE_ARRAY_SIZE_THRESHOLD">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">INLINE_ARRAY_SIZE_THRESHOLD</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#econox.config.INLINE_ARRAY_SIZE_THRESHOLD" title="Link to this definition">¶</a></dt>
<dd><p>Arrays with size &lt;= this value will be saved inline in summary.txt and metadata.json.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.SUMMARY_STRING_MAX_LENGTH">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">SUMMARY_STRING_MAX_LENGTH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#econox.config.SUMMARY_STRING_MAX_LENGTH" title="Link to this definition">¶</a></dt>
<dd><p>Maximum length for string representations in summary.txt before adding ‘…’.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.FLATTEN_MULTIDIM_ARRAYS">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">FLATTEN_MULTIDIM_ARRAYS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#econox.config.FLATTEN_MULTIDIM_ARRAYS" title="Link to this definition">¶</a></dt>
<dd><p>If True, arrays with &gt;2 dimensions will be flattened when saving to CSV.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.SUMMARY_FIELD_WIDTH">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">SUMMARY_FIELD_WIDTH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">25</span></em><a class="headerlink" href="#econox.config.SUMMARY_FIELD_WIDTH" title="Link to this definition">¶</a></dt>
<dd><p>Width for field name padding in summary.txt.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.SUMMARY_DICT_KEY_WIDTH">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">SUMMARY_DICT_KEY_WIDTH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">21</span></em><a class="headerlink" href="#econox.config.SUMMARY_DICT_KEY_WIDTH" title="Link to this definition">¶</a></dt>
<dd><p>Width for dictionary key padding in summary.txt.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.SUMMARY_SEPARATOR_LENGTH">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">SUMMARY_SEPARATOR_LENGTH</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">60</span></em><a class="headerlink" href="#econox.config.SUMMARY_SEPARATOR_LENGTH" title="Link to this definition">¶</a></dt>
<dd><p>Length of separator lines (=== bars) in summary.txt.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="econox.config.LOSS_PENALTY">
<span class="sig-prename descclassname"><span class="pre">econox.config.</span></span><span class="sig-name descname"><span class="pre">LOSS_PENALTY</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#econox.config.LOSS_PENALTY" title="Link to this definition">¶</a></dt>
<dd><p>Penalty value returned for invalid model solutions during optimization.
Used to steer the optimizer away from unstable parameter regions.
Default is positive infinity.</p>
</dd></dl>

</section>
<section id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Import Note</strong>: Helper functions are located in the <code class="docutils literal notranslate"><span class="pre">econox.utils</span></code> submodule.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">econox.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_from_pytree</span>
</pre></div>
</div>
</div>
<p>General utility functions for array manipulation and PyTree handling.</p>
<p id="module-econox.utils">General utility functions shared across the Econox package.</p>
<dl class="py function">
<dt class="sig sig-object py" id="econox.utils.get_from_pytree">
<span class="sig-prename descclassname"><span class="pre">econox.utils.</span></span><span class="sig-name descname"><span class="pre">get_from_pytree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">_MISSING</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/econox/utils.html#get_from_pytree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#econox.utils.get_from_pytree" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve a value from a data container, supporting both dict-style ([‘key’])
and attribute-style (.key) access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span>) – The container (dict, NamedTuple, PyTree, etc.).</p></li>
<li><p><strong>key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The key or attribute name to retrieve.</p></li>
<li><p><strong>default</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>), <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>]</span>) – Value to return if key is not found. If not provided, raises error.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>)]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The value associated with the key, or default if not found.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If data is dict-like and key is missing (and no default).</p></li>
<li><p><strong>AttributeError</strong> – If data is object-like and attribute is missing (and no default).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Haruto Ito
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#workflow-high-level-api">Workflow (High-Level API)</a><ul>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator"><code class="docutils literal notranslate"><span class="pre">Estimator</span></code></a><ul>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.model"><code class="docutils literal notranslate"><span class="pre">Estimator.model</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.param_space"><code class="docutils literal notranslate"><span class="pre">Estimator.param_space</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.method"><code class="docutils literal notranslate"><span class="pre">Estimator.method</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.solver"><code class="docutils literal notranslate"><span class="pre">Estimator.solver</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.optimizer"><code class="docutils literal notranslate"><span class="pre">Estimator.optimizer</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.verbose"><code class="docutils literal notranslate"><span class="pre">Estimator.verbose</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.fit"><code class="docutils literal notranslate"><span class="pre">Estimator.fit()</span></code></a></li>
<li><a class="reference internal" href="#econox.workflow.estimator.Estimator.__init__"><code class="docutils literal notranslate"><span class="pre">Estimator.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#core-interfaces-protocols">Core Interfaces (Protocols)</a><ul>
<li><a class="reference internal" href="#econox.protocols.StructuralModel"><code class="docutils literal notranslate"><span class="pre">StructuralModel</span></code></a><ul>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.num_states"><code class="docutils literal notranslate"><span class="pre">StructuralModel.num_states</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.num_actions"><code class="docutils literal notranslate"><span class="pre">StructuralModel.num_actions</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.num_periods"><code class="docutils literal notranslate"><span class="pre">StructuralModel.num_periods</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.data"><code class="docutils literal notranslate"><span class="pre">StructuralModel.data</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.transitions"><code class="docutils literal notranslate"><span class="pre">StructuralModel.transitions</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.availability"><code class="docutils literal notranslate"><span class="pre">StructuralModel.availability</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.StructuralModel.replace_data"><code class="docutils literal notranslate"><span class="pre">StructuralModel.replace_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.protocols.Utility"><code class="docutils literal notranslate"><span class="pre">Utility</span></code></a><ul>
<li><a class="reference internal" href="#econox.protocols.Utility.compute_flow_utility"><code class="docutils literal notranslate"><span class="pre">Utility.compute_flow_utility()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.protocols.Distribution"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a><ul>
<li><a class="reference internal" href="#econox.protocols.Distribution.expected_max"><code class="docutils literal notranslate"><span class="pre">Distribution.expected_max()</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.Distribution.choice_probabilities"><code class="docutils literal notranslate"><span class="pre">Distribution.choice_probabilities()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.protocols.FeedbackMechanism"><code class="docutils literal notranslate"><span class="pre">FeedbackMechanism</span></code></a><ul>
<li><a class="reference internal" href="#econox.protocols.FeedbackMechanism.update"><code class="docutils literal notranslate"><span class="pre">FeedbackMechanism.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.protocols.Dynamics"><code class="docutils literal notranslate"><span class="pre">Dynamics</span></code></a></li>
<li><a class="reference internal" href="#econox.protocols.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li><a class="reference internal" href="#econox.protocols.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#structures-data-state">Structures (Data &amp; State)</a><ul>
<li><a class="reference internal" href="#module-econox.structures.model">Structural Model</a><ul>
<li><a class="reference internal" href="#econox.structures.model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li><a class="reference internal" href="#econox.structures.model.Model.num_states"><code class="docutils literal notranslate"><span class="pre">Model.num_states</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.num_actions"><code class="docutils literal notranslate"><span class="pre">Model.num_actions</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.data"><code class="docutils literal notranslate"><span class="pre">Model.data</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.num_periods"><code class="docutils literal notranslate"><span class="pre">Model.num_periods</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.availability"><code class="docutils literal notranslate"><span class="pre">Model.availability</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.transitions"><code class="docutils literal notranslate"><span class="pre">Model.transitions</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.__init__"><code class="docutils literal notranslate"><span class="pre">Model.__init__()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.from_data"><code class="docutils literal notranslate"><span class="pre">Model.from_data()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.replace_data"><code class="docutils literal notranslate"><span class="pre">Model.replace_data()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.features"><code class="docutils literal notranslate"><span class="pre">Model.features</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.get"><code class="docutils literal notranslate"><span class="pre">Model.get()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.model.Model.shapes"><code class="docutils literal notranslate"><span class="pre">Model.shapes</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.structures.params">Parameter Management</a><ul>
<li><a class="reference internal" href="#econox.structures.params.ConstraintKind"><code class="docutils literal notranslate"><span class="pre">ConstraintKind</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace"><code class="docutils literal notranslate"><span class="pre">ParameterSpace</span></code></a><ul>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.initial_params"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.initial_params</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.constraints"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.constraints</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.bounds"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.bounds</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.eps"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.eps</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.log_clip_min"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.log_clip_min</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.__init__"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.__init__()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.log_clip_max"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.log_clip_max</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.create"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.create()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.transform"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.transform()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.inverse_transform"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.inverse_transform()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.get_bounds"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.get_bounds()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.params.ParameterSpace.fixed_mask"><code class="docutils literal notranslate"><span class="pre">ParameterSpace.fixed_mask</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.structures.results">Result Containers</a><ul>
<li><a class="reference internal" href="#econox.structures.results.ResultMixin"><code class="docutils literal notranslate"><span class="pre">ResultMixin</span></code></a><ul>
<li><a class="reference internal" href="#econox.structures.results.ResultMixin.save"><code class="docutils literal notranslate"><span class="pre">ResultMixin.save()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult"><code class="docutils literal notranslate"><span class="pre">SolverResult</span></code></a><ul>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.solution"><code class="docutils literal notranslate"><span class="pre">SolverResult.solution</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.profile"><code class="docutils literal notranslate"><span class="pre">SolverResult.profile</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.inner_result"><code class="docutils literal notranslate"><span class="pre">SolverResult.inner_result</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.success"><code class="docutils literal notranslate"><span class="pre">SolverResult.success</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.aux"><code class="docutils literal notranslate"><span class="pre">SolverResult.aux</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.SolverResult.__init__"><code class="docutils literal notranslate"><span class="pre">SolverResult.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult"><code class="docutils literal notranslate"><span class="pre">EstimationResult</span></code></a><ul>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.params"><code class="docutils literal notranslate"><span class="pre">EstimationResult.params</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.loss"><code class="docutils literal notranslate"><span class="pre">EstimationResult.loss</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.__init__"><code class="docutils literal notranslate"><span class="pre">EstimationResult.__init__()</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.success"><code class="docutils literal notranslate"><span class="pre">EstimationResult.success</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.solver_result"><code class="docutils literal notranslate"><span class="pre">EstimationResult.solver_result</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.std_errors"><code class="docutils literal notranslate"><span class="pre">EstimationResult.std_errors</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.vcov"><code class="docutils literal notranslate"><span class="pre">EstimationResult.vcov</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.r_squared"><code class="docutils literal notranslate"><span class="pre">EstimationResult.r_squared</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.meta"><code class="docutils literal notranslate"><span class="pre">EstimationResult.meta</span></code></a></li>
<li><a class="reference internal" href="#econox.structures.results.EstimationResult.t_values"><code class="docutils literal notranslate"><span class="pre">EstimationResult.t_values</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#logic-physics-rules">Logic (Physics &amp; Rules)</a><ul>
<li><a class="reference internal" href="#module-econox.logic.utility">Utility Functions</a><ul>
<li><a class="reference internal" href="#econox.logic.utility.LinearUtility"><code class="docutils literal notranslate"><span class="pre">LinearUtility</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.utility.LinearUtility.param_keys"><code class="docutils literal notranslate"><span class="pre">LinearUtility.param_keys</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.utility.LinearUtility.feature_key"><code class="docutils literal notranslate"><span class="pre">LinearUtility.feature_key</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.utility.LinearUtility.compute_flow_utility"><code class="docutils literal notranslate"><span class="pre">LinearUtility.compute_flow_utility()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.utility.LinearUtility.__init__"><code class="docutils literal notranslate"><span class="pre">LinearUtility.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.utility.FunctionUtility"><code class="docutils literal notranslate"><span class="pre">FunctionUtility</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.utility.FunctionUtility.func"><code class="docutils literal notranslate"><span class="pre">FunctionUtility.func</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.utility.FunctionUtility.__init__"><code class="docutils literal notranslate"><span class="pre">FunctionUtility.__init__()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.utility.FunctionUtility.compute_flow_utility"><code class="docutils literal notranslate"><span class="pre">FunctionUtility.compute_flow_utility()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.utility.utility"><code class="docutils literal notranslate"><span class="pre">utility()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.logic.distribution">Probability Distributions</a><ul>
<li><a class="reference internal" href="#econox.logic.distribution.GumbelDistribution"><code class="docutils literal notranslate"><span class="pre">GumbelDistribution</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.distribution.GumbelDistribution.scale"><code class="docutils literal notranslate"><span class="pre">GumbelDistribution.scale</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.distribution.GumbelDistribution.expected_max"><code class="docutils literal notranslate"><span class="pre">GumbelDistribution.expected_max()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.distribution.GumbelDistribution.choice_probabilities"><code class="docutils literal notranslate"><span class="pre">GumbelDistribution.choice_probabilities()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.distribution.GumbelDistribution.__init__"><code class="docutils literal notranslate"><span class="pre">GumbelDistribution.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.logic.feedback">Feedback Mechanisms</a><ul>
<li><a class="reference internal" href="#econox.logic.feedback.CompositeFeedback"><code class="docutils literal notranslate"><span class="pre">CompositeFeedback</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.feedback.CompositeFeedback.feedbacks"><code class="docutils literal notranslate"><span class="pre">CompositeFeedback.feedbacks</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.CompositeFeedback.update"><code class="docutils literal notranslate"><span class="pre">CompositeFeedback.update()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.CompositeFeedback.__init__"><code class="docutils literal notranslate"><span class="pre">CompositeFeedback.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.feedback.CustomUpdateFeedback"><code class="docutils literal notranslate"><span class="pre">CustomUpdateFeedback</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.feedback.CustomUpdateFeedback.func"><code class="docutils literal notranslate"><span class="pre">CustomUpdateFeedback.func</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.CustomUpdateFeedback.update"><code class="docutils literal notranslate"><span class="pre">CustomUpdateFeedback.update()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.CustomUpdateFeedback.__init__"><code class="docutils literal notranslate"><span class="pre">CustomUpdateFeedback.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.feedback.model_feedback"><code class="docutils literal notranslate"><span class="pre">model_feedback()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.FunctionFeedback"><code class="docutils literal notranslate"><span class="pre">FunctionFeedback</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.feedback.FunctionFeedback.func"><code class="docutils literal notranslate"><span class="pre">FunctionFeedback.func</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.FunctionFeedback.target_key"><code class="docutils literal notranslate"><span class="pre">FunctionFeedback.target_key</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.FunctionFeedback.update"><code class="docutils literal notranslate"><span class="pre">FunctionFeedback.update()</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.feedback.FunctionFeedback.__init__"><code class="docutils literal notranslate"><span class="pre">FunctionFeedback.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.feedback.function_feedback"><code class="docutils literal notranslate"><span class="pre">function_feedback()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.logic.dynamics">Transition Dynamics</a><ul>
<li><a class="reference internal" href="#econox.logic.dynamics.SimpleDynamics"><code class="docutils literal notranslate"><span class="pre">SimpleDynamics</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.dynamics.SimpleDynamics.use_transitions"><code class="docutils literal notranslate"><span class="pre">SimpleDynamics.use_transitions</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.dynamics.SimpleDynamics.__init__"><code class="docutils literal notranslate"><span class="pre">SimpleDynamics.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.logic.dynamics.TrajectoryDynamics"><code class="docutils literal notranslate"><span class="pre">TrajectoryDynamics</span></code></a><ul>
<li><a class="reference internal" href="#econox.logic.dynamics.TrajectoryDynamics.enforce_boundary"><code class="docutils literal notranslate"><span class="pre">TrajectoryDynamics.enforce_boundary</span></code></a></li>
<li><a class="reference internal" href="#econox.logic.dynamics.TrajectoryDynamics.__init__"><code class="docutils literal notranslate"><span class="pre">TrajectoryDynamics.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#solvers-algorithms">Solvers (Algorithms)</a><ul>
<li><a class="reference internal" href="#module-econox.solvers.dynamic_programming">Dynamic Programming</a><ul>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver</span></code></a><ul>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.utility"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.utility</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.dist"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.dist</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.discount_factor"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.discount_factor</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.numerical_solver"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.numerical_solver</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.solve"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.solve()</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.dynamic_programming.ValueIterationSolver.__init__"><code class="docutils literal notranslate"><span class="pre">ValueIterationSolver.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.solvers.equilibrium">Equilibrium Solvers</a><ul>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver</span></code></a><ul>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.inner_solver"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.inner_solver</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.feedback"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.feedback</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.dynamics"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.dynamics</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.numerical_solver"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.numerical_solver</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.damping"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.damping</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.initial_distribution"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.initial_distribution</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.solve"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.solve()</span></code></a></li>
<li><a class="reference internal" href="#econox.solvers.equilibrium.EquilibriumSolver.__init__"><code class="docutils literal notranslate"><span class="pre">EquilibriumSolver.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#optimization-backends">Optimization Backends</a><ul>
<li><a class="reference internal" href="#econox.optim.MinimizerResult"><code class="docutils literal notranslate"><span class="pre">MinimizerResult</span></code></a><ul>
<li><a class="reference internal" href="#econox.optim.MinimizerResult.params"><code class="docutils literal notranslate"><span class="pre">MinimizerResult.params</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.MinimizerResult.loss"><code class="docutils literal notranslate"><span class="pre">MinimizerResult.loss</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.MinimizerResult.success"><code class="docutils literal notranslate"><span class="pre">MinimizerResult.success</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.MinimizerResult.steps"><code class="docutils literal notranslate"><span class="pre">MinimizerResult.steps</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.MinimizerResult.__init__"><code class="docutils literal notranslate"><span class="pre">MinimizerResult.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.optim.Minimizer"><code class="docutils literal notranslate"><span class="pre">Minimizer</span></code></a><ul>
<li><a class="reference internal" href="#econox.optim.Minimizer.method"><code class="docutils literal notranslate"><span class="pre">Minimizer.method</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.Minimizer.max_steps"><code class="docutils literal notranslate"><span class="pre">Minimizer.max_steps</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.Minimizer.throw"><code class="docutils literal notranslate"><span class="pre">Minimizer.throw</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.Minimizer.minimize"><code class="docutils literal notranslate"><span class="pre">Minimizer.minimize()</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.Minimizer.__init__"><code class="docutils literal notranslate"><span class="pre">Minimizer.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.optim.FixedPointResult"><code class="docutils literal notranslate"><span class="pre">FixedPointResult</span></code></a><ul>
<li><a class="reference internal" href="#econox.optim.FixedPointResult.value"><code class="docutils literal notranslate"><span class="pre">FixedPointResult.value</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPointResult.success"><code class="docutils literal notranslate"><span class="pre">FixedPointResult.success</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPointResult.steps"><code class="docutils literal notranslate"><span class="pre">FixedPointResult.steps</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPointResult.__init__"><code class="docutils literal notranslate"><span class="pre">FixedPointResult.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.optim.FixedPoint"><code class="docutils literal notranslate"><span class="pre">FixedPoint</span></code></a><ul>
<li><a class="reference internal" href="#econox.optim.FixedPoint.method"><code class="docutils literal notranslate"><span class="pre">FixedPoint.method</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPoint.max_steps"><code class="docutils literal notranslate"><span class="pre">FixedPoint.max_steps</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPoint.throw"><code class="docutils literal notranslate"><span class="pre">FixedPoint.throw</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPoint.adjoint"><code class="docutils literal notranslate"><span class="pre">FixedPoint.adjoint</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPoint.find_fixed_point"><code class="docutils literal notranslate"><span class="pre">FixedPoint.find_fixed_point()</span></code></a></li>
<li><a class="reference internal" href="#econox.optim.FixedPoint.__init__"><code class="docutils literal notranslate"><span class="pre">FixedPoint.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#methods-estimation-techniques">Methods (Estimation Techniques)</a><ul>
<li><a class="reference internal" href="#module-econox.methods.base">Base Classes</a><ul>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod"><code class="docutils literal notranslate"><span class="pre">EstimationMethod</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod.variance"><code class="docutils literal notranslate"><span class="pre">EstimationMethod.variance</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod.compute_loss"><code class="docutils literal notranslate"><span class="pre">EstimationMethod.compute_loss()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod.solve"><code class="docutils literal notranslate"><span class="pre">EstimationMethod.solve()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod.from_function"><code class="docutils literal notranslate"><span class="pre">EstimationMethod.from_function()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.base.EstimationMethod.__init__"><code class="docutils literal notranslate"><span class="pre">EstimationMethod.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.base.method_from_loss"><code class="docutils literal notranslate"><span class="pre">method_from_loss()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.methods.analytical">Analytical Methods (OLS/2SLS)</a><ul>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.is_fixed_mask"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.is_fixed_mask</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.fixed_values_vec"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.fixed_values_vec</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.param_names"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.param_names</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.n_total"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.n_total</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.n_fixed"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.n_fixed</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.n_free"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.n_free</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.from_params"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.from_params()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.transform"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.transform()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.reconstruct"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.reconstruct()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.AnalyticalParameterHandler.__init__"><code class="docutils literal notranslate"><span class="pre">AnalyticalParameterHandler.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod"><code class="docutils literal notranslate"><span class="pre">LinearMethod</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.add_intercept"><code class="docutils literal notranslate"><span class="pre">LinearMethod.add_intercept</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.target_key"><code class="docutils literal notranslate"><span class="pre">LinearMethod.target_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.param_names"><code class="docutils literal notranslate"><span class="pre">LinearMethod.param_names</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.solve"><code class="docutils literal notranslate"><span class="pre">LinearMethod.solve()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.compute_loss"><code class="docutils literal notranslate"><span class="pre">LinearMethod.compute_loss()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LinearMethod.__init__"><code class="docutils literal notranslate"><span class="pre">LinearMethod.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.analytical.LeastSquares"><code class="docutils literal notranslate"><span class="pre">LeastSquares</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.analytical.LeastSquares.feature_key"><code class="docutils literal notranslate"><span class="pre">LeastSquares.feature_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.LeastSquares.__init__"><code class="docutils literal notranslate"><span class="pre">LeastSquares.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.analytical.TwoStageLeastSquares"><code class="docutils literal notranslate"><span class="pre">TwoStageLeastSquares</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.analytical.TwoStageLeastSquares.endog_key"><code class="docutils literal notranslate"><span class="pre">TwoStageLeastSquares.endog_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.TwoStageLeastSquares.instrument_key"><code class="docutils literal notranslate"><span class="pre">TwoStageLeastSquares.instrument_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.TwoStageLeastSquares.controls_key"><code class="docutils literal notranslate"><span class="pre">TwoStageLeastSquares.controls_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.analytical.TwoStageLeastSquares.__init__"><code class="docutils literal notranslate"><span class="pre">TwoStageLeastSquares.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.methods.numerical">Numerical Methods (MLE/GMM)</a><ul>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod"><code class="docutils literal notranslate"><span class="pre">CompositeMethod</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod.methods"><code class="docutils literal notranslate"><span class="pre">CompositeMethod.methods</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod.weights"><code class="docutils literal notranslate"><span class="pre">CompositeMethod.weights</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod.variance"><code class="docutils literal notranslate"><span class="pre">CompositeMethod.variance</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod.compute_loss"><code class="docutils literal notranslate"><span class="pre">CompositeMethod.compute_loss()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.CompositeMethod.__init__"><code class="docutils literal notranslate"><span class="pre">CompositeMethod.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.numerical.MaximumLikelihood"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihood</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.numerical.MaximumLikelihood.choice_probs_key"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihood.choice_probs_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.MaximumLikelihood.compute_loss"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihood.compute_loss()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.MaximumLikelihood.__init__"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihood.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.obs_key"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.obs_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.model_key"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.model_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.scale_param_key"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.scale_param_key</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.log_transform"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.log_transform</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.variance"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.variance</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.__init__"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.__init__()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.numerical.GaussianMomentMatch.compute_loss"><code class="docutils literal notranslate"><span class="pre">GaussianMomentMatch.compute_loss()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-econox.methods.variance">Variance &amp; Inference</a><ul>
<li><a class="reference internal" href="#econox.methods.variance.Variance"><code class="docutils literal notranslate"><span class="pre">Variance</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.variance.Variance.compute"><code class="docutils literal notranslate"><span class="pre">Variance.compute()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.variance.Variance.__init__"><code class="docutils literal notranslate"><span class="pre">Variance.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#econox.methods.variance.Hessian"><code class="docutils literal notranslate"><span class="pre">Hessian</span></code></a><ul>
<li><a class="reference internal" href="#econox.methods.variance.Hessian.compute"><code class="docutils literal notranslate"><span class="pre">Hessian.compute()</span></code></a></li>
<li><a class="reference internal" href="#econox.methods.variance.Hessian.__init__"><code class="docutils literal notranslate"><span class="pre">Hessian.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#econox.config.INLINE_ARRAY_SIZE_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">INLINE_ARRAY_SIZE_THRESHOLD</span></code></a></li>
<li><a class="reference internal" href="#econox.config.SUMMARY_STRING_MAX_LENGTH"><code class="docutils literal notranslate"><span class="pre">SUMMARY_STRING_MAX_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#econox.config.FLATTEN_MULTIDIM_ARRAYS"><code class="docutils literal notranslate"><span class="pre">FLATTEN_MULTIDIM_ARRAYS</span></code></a></li>
<li><a class="reference internal" href="#econox.config.SUMMARY_FIELD_WIDTH"><code class="docutils literal notranslate"><span class="pre">SUMMARY_FIELD_WIDTH</span></code></a></li>
<li><a class="reference internal" href="#econox.config.SUMMARY_DICT_KEY_WIDTH"><code class="docutils literal notranslate"><span class="pre">SUMMARY_DICT_KEY_WIDTH</span></code></a></li>
<li><a class="reference internal" href="#econox.config.SUMMARY_SEPARATOR_LENGTH"><code class="docutils literal notranslate"><span class="pre">SUMMARY_SEPARATOR_LENGTH</span></code></a></li>
<li><a class="reference internal" href="#econox.config.LOSS_PENALTY"><code class="docutils literal notranslate"><span class="pre">LOSS_PENALTY</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utilities">Utilities</a><ul>
<li><a class="reference internal" href="#econox.utils.get_from_pytree"><code class="docutils literal notranslate"><span class="pre">get_from_pytree()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=92734c54"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>